(()=>{"use strict";var e,t={7632:(e,t,a)=>{a.d(t,{Z:()=>i});var s=a(7294),n=a(4214),r=a(6872);class i extends s.Component{constructor(e){super(e),void 0===this.props.data.show&&(this.props.data.show=!0)}render(){return this.props.data.show?s.createElement("div",{className:"col-lg-12 col-md-12 col-sm-12",style:{margin:"1em 0",border:this.props.style?this.props.style.border:"1px dashed #337b5b"}},s.createElement(s.Fragment,null,this.props.data.title?s.createElement("h6",{style:{margin:"1em .5em",color:"#007bff"}},this.props.data.title):null,s.createElement("div",{className:"col-12"},s.createElement(n.Y,{fields:this.props.data.fields})),s.createElement("div",{className:"col-lg-12 col-md-12 col-sm-12",style:{margin:"1em 0"}},s.createElement("button",{type:"button",className:"btn btn-green btn-outlined btn-xs",onClick:()=>{let e=(0,r.Rj)(this.props.data.fields);if(e)return void alert(e);let t=this.props.data.fields.reduce(((e,t)=>Object.assign(e,{[t.attr]:t.value})),{}),a={};this.props.data._ofields&&(a=this.props.data._ofields.reduce(((e,t)=>Object.assign(e,{[t.attr]:t.value})),{})),this.props.onEditOK(t,a)}},"确定"),"  ",s.createElement("button",{type:"button",className:"btn btn-green btn-outlined btn-xs",onClick:()=>{this.props.data.show=!1,this.forceUpdate(),this.props.onEditCancel&&this.props.onEditCancel()}},"取消")))):null}}},7407:(e,t,a)=>{a.d(t,{Rm:()=>l,vr:()=>o,aw:()=>c});var s=a(7294),n=a(6872);s.Component,s.Component;class r extends s.Component{constructor(e){super(e),this.editId="tedit_"+Math.random().toString(36).substring(2)}createTEdit(){this.tedit=new tui.Editor({el:document.querySelector("#"+this.editId),previewStyle:"vertical",height:"auto",minHeight:"260px",initialEditType:"wysiwyg",initialValue:this.props.value,language:"zh",hideModeSwitch:!0,usageStatistics:!1,events:{load:()=>{let e=document.querySelector("#"+this.editId),t=e.getAttribute("style");e.setAttribute("style",t+"font-size:.9em;")},change:()=>{this.props.onChange(this.tedit.getMarkdown())}},hooks:{addImageBlobHook:async(e,t,a)=>{let s=new FormData;s.append("upload1",e),s.append("file",e);const r=await fetch(n.FO,{method:"POST",body:s});let i=await r.json();t(i.url,i.url)}}})}componentDidMount(){this.createTEdit()}componentDidUpdate(e){this.props.value!==e.value&&(this.tedit.remove(),this.createTEdit())}render(){return s.createElement("div",{id:this.editId})}}class i extends s.Component{constructor(e){super(e),this.editId="tedit_"+Math.random().toString(36).substring(2)}createTEdit(e){this.tedit=tui.Editor.factory({el:document.querySelector("#"+this.editId),viewer:!0,height:"auto",initialValue:e,linkAttribute:{target:"_blank"},hooks:{convertorAfterMarkdownToHtmlConverted:e=>e.replace(/<a href="(\/upload\/.*?)\.(.+?)">(.+?)<\/a>/g,((e,t,a,s)=>{let r=a,i=s,l=n.DR[r]?n.DR[r]:"file";return["mp4","avi"].includes(r)?`\n\n                <a href="/view_one.html?type=video&src=${t}.${r}&name=${i}" target='_blank' class='byhy-link'>              \n                  <img src="/assets/images/${l}.png" />\n                  <span>${i}</span> \n                </a>\n`:`\n\n              <a href="${t}.${r}" download='${i}' class='byhy-link'>              \n                <img src="/assets/images/${l}.png" />\n                <span>${i}</span> \n              </a>\n`}))}})}componentDidMount(){this.createTEdit(this.props.value)}componentDidUpdate(e){if(this.props.value===e.value)return;this.tedit.remove();let t=""===this.props.value?"无":this.props.value;this.createTEdit(t)}render(){return s.createElement("div",{id:this.editId})}}let l=r,o=class extends r{constructor(e){super(e),this.uploaderId="uploader_"+Math.random().toString(36).substring(2),this.state={errors:""}}createLinkFileMark(e){return`\n|%-${JSON.stringify(e)}-%|`}componentDidMount(){let e=this;this.dropzone=new Dropzone("#"+this.uploaderId,{url:"/api/upload",createImageThumbnails:!1,clickable:!1,paramName:"upload1",success:function(t,a){this.removeFile(t),e.tedit.insertText("\n"),e.tedit.exec("AddLink",{url:a.url,linkText:t.name})},error:function(t,a){this.removeFile(t),e.tedit.insertText(`\n上传 ${t.name} 失败 : ${a.msg} | ${a}`)},dictInvalidFileType:"不支持的文件类型"}),this.createTEdit()}render(){return s.createElement(s.Fragment,null,s.createElement("div",{id:this.uploaderId,className:"dropzone",style:{border:"0px dashed #85b2c7",padding:"0"}},s.createElement("div",{id:this.editId}),s.createElement("div",{className:"dz-default dz-message",style:{margin:"0"}})),this.state.errors?s.createElement("div",{type:"text",style:{color:"red",cursor:"pointer"},onClick:()=>{this.state.errors=null,this.forceUpdate()}},this.state.errors):null)}},c=i},6239:(e,t,a)=>{a.d(t,{bW:()=>i,_A:()=>l,A1:()=>o,cm:()=>m,u9:()=>d});var s=a(7294),n=a(6872);class r extends s.Component{constructor(e){super(e),this.state={searchKeyword:"",searching:!1,items:[]},this.oName=this.props.info.optionname,this.oValue=this.props.info.optionvalue}async getOptionItems(){this.setState({items:[]});let e=await this.props.info.searchfunc(this.state.searchKeyword);this.setState({items:e})}ui_Part_SearchBox(){return this.state.items.length>8||this.state.searching?s.createElement("input",{className:"form-control",placeholder:"请输入关键字查找",style:{width:"50%",borderRadius:"0",border:"1px solid #aec4ae",height:"2em",borderBottom:"#d5d5e7",marginTop:".3em"},value:this.state.searchKeyword,onChange:e=>{this.setState({searchKeyword:e.target.value})},onKeyDown:async e=>{if("Enter"!==e.key)return;0===this.state.searchKeyword.length?this.state.searching=!1:this.state.searching=!0;let t=await this.props.info.searchfunc(this.state.searchKeyword);this.setState({items:t})}}):null}ui_Part_SelectBox(){return s.createElement(s.Fragment,null,s.createElement("select",{className:"form-control",id:this.eleId,size:this.props.listnum?this.props.listnum:3,style:{width:"50%",border:"1px #3c763d solid",marginRight:"1em",borderRadius:"0",fontSize:".92em",display:"inline"},onClick:e=>{this.onChangeSelection(e)}},this.state.items.map((e=>s.createElement("option",{key:e[this.oValue],value:e[this.oValue]},e[this.oName])))),s.createElement("span",{className:"fas fa-sync",style:{cursor:"pointer",color:"#3d9970"},onClick:()=>this.getOptionItems()}))}render(){return s.createElement(s.Fragment,null,this.ui_Part_SelectedItems(),s.createElement("div",{style:{marginTop:".3em"}},this.ui_Part_SearchBox(),this.ui_Part_SelectBox()))}}class i extends r{constructor(e){super(e),this.state.selected=null}async componentDidMount(){let e=await this.props.info.searchfunc("");if(this.setState({items:e}),null!==this.props.info.value)for(var t of e)t[this.oValue]===this.props.info.value&&(this.state.selected=t)}onChangeSelection(e){let t=parseInt(e.target.value);for(var a of this.state.items)a[this.oValue]===t&&(this.props.info.value=t,this.state.selected=a);this.props.info.selectchange&&this.props.info.selectchange(this.state.selected),this.forceUpdate()}ui_Part_SelectedItems(){return null===this.state.selected?null:s.createElement("span",{style:{marginLeft:"1em",padding:".1em",border:"1px #337ab7 solid",cursor:"pointer"},onClick:e=>{this.state.selected=null,this.props.info.value=null,this.props.info.selectchange&&this.props.info.selectchange(null),this.forceUpdate()}},this.state.selected[this.oName])}}class l extends r{constructor(e){super(e),this.state.selected=[]}async componentDidMount(){let e=await this.props.info.searchfunc(this.state.searchKeyword);for(var t of this.props.info.value)for(const a of e)t===a[this.oValue]&&this.state.selected.push(a);this.setState({items:e})}ui_Part_SelectedItems(){return this.state.selected.map((e=>s.createElement("span",{key:e[this.oValue],style:{marginLeft:"1em",padding:".1em",border:"1px #337ab7 solid",cursor:"pointer",fontSize:".92em"},onClick:t=>{let a=this.state.selected.indexOf(e);this.state.selected.splice(a,1),this.props.info.value=this.state.selected.map((e=>e[this.oValue])),this.forceUpdate()}},e[this.oName]+" X ")))}onChangeSelection(e){let t=parseInt(e.target.value);if(!(this.props.info.value.length>=this.props.info.maxnum)){for(var a of this.props.info.value)if(a===t)return;for(var s of this.state.items)s[this.oValue]===t&&(this.state.selected.push(s),this.props.info.value=this.state.selected.map((e=>e[this.oValue])));this.forceUpdate()}}}class o extends l{constructor(e){super(e)}ui_Part_SelectedItemsValues(){return this.state.selected.map((e=>s.createElement("div",{key:e[this.oValue],style:{marginTop:".2em"}},s.createElement("span",{style:{marginLeft:"1em",padding:".1em",display:"inline-block",minWidth:"8em"}},e[this.oName]),s.createElement("input",{type:"number",value:e.v,style:{marginLeft:".3em",border:"1px #337ab7 solid",width:"5em"},onChange:t=>{e.v=t.target.value,this.forceUpdate()}}),s.createElement("span",{style:{marginLeft:".5em",padding:".5em",cursor:"pointer",color:"red"},onClick:t=>{let a=this.state.selected.indexOf(e);this.state.selected.splice(a,1),this.props.info.value=this.state.selected.map((e=>e[this.oValue])),this.forceUpdate()}},"X"))))}render(){return s.createElement(s.Fragment,null,this.ui_Part_SelectedItemsValues(),this.ui_Part_SearchBox(),this.ui_Part_SelectBox())}}class c extends s.Component{constructor(e){super(e),this.status="span"}render(){return"span"===this.status?s.createElement("span",{onClick:()=>{this.status="input",this.forceUpdate()}},this.props.data[this.props.displayAttr]):s.createElement("input",{className:"form-control",style:{marginRight:"3em"},value:this.props.data[this.props.displayAttr],onChange:e=>{this.props.data[this.props.displayAttr]=e.target.value,this.forceUpdate()},onKeyPress:e=>{"Enter"==e.key&&(this.status="span"),this.forceUpdate()}})}}class m extends s.Component{constructor(e){super(e),this.dndSrc={item:null}}onDragStart(e,t){this.dndSrc.item=t}onDrop(e,t){if(this.dndSrc.item===t)return;e.preventDefault();let a=this.props.items,s=a.indexOf(this.dndSrc.item),n=a.indexOf(t);a[s]=t,a[n]=this.dndSrc.item,this.forceUpdate()}onDragOver(e,t){this.dndSrc.item!==t&&e.preventDefault()}render(){return this.props.items.map(((e,t)=>s.createElement("div",{key:t,style:{background:this.props.background?this.props.background:"#ebf4f5",display:"flex",borderBottom:"1px solid #c8ccce",minHeight:"2.4em",padding:"0.4em 1em"},draggable:"true",onDragStart:t=>{this.onDragStart(t,e)},onDrop:t=>{this.onDrop(t,e)},onDragOver:t=>{this.onDragOver(t,e)}},s.createElement(c,{data:e,displayAttr:this.props.displayAttr}),s.createElement("span",{type:"button",style:{marginLeft:"auto"},onClick:()=>{if(this.props.delConfirm&&!confirm("确定删除吗？"))return;let t=this.props.items;for(let a=0;a<=t.length;a++)if(t[a]===e){t.splice(a,1);break}this.forceUpdate(),this.props.deleteOne&&this.props.deleteOne()}},"删除"))))}}class d extends s.Component{constructor(e){super(e),this.dndSrc={item:null}}onDragStart(e,t){this.dndSrc.item=t}onDrop(e,t){if(this.dndSrc.item===t)return;e.preventDefault();let a=n.R3.MAGIC_BAG[this.props.zone],s=a.indexOf(this.dndSrc.item),r=a.indexOf(t);a[s]=t,a[r]=this.dndSrc.item,this.forceUpdate()}onDragOver(e,t){this.dndSrc.item!==t&&e.preventDefault()}render(){let e=n.R3.MAGIC_BAG;return e.hasOwnProperty(this.props.zone)&&0!==e[this.props.zone].length?s.createElement(s.Fragment,null,e[this.props.zone].map(((t,a)=>s.createElement("div",{key:a,style:{background:this.props.background?this.props.background:"#ebf4f5",display:"flex",borderBottom:"1px solid #c8ccce",minHeight:"2.4em",padding:"0.4em 1em"},draggable:"true",onDragStart:e=>{this.onDragStart(e,t)},onDrop:e=>{this.onDrop(e,t)},onDragOver:e=>{this.onDragOver(e,t)},onDoubleClick:e=>{this.props.doubleClickOne&&this.props.doubleClickOne(t)}},s.createElement("span",null,t[this.props.displayAttr]," "),s.createElement("span",{type:"button",style:{marginLeft:"auto"},onClick:()=>{if(!confirm("确定删除吗？"))return;let a=e[this.props.zone];for(let e=0;e<=a.length;e++)if(a[e]===t){a.splice(e,1);break}this.forceUpdate(),this.props.deleteOne&&this.props.deleteOne()}},"删除")))),s.createElement("span",{style:{cursor:"pointer",color:"#2196F3"},onClick:t=>{e[this.props.zone].length=0,this.forceUpdate()}},"清空手推车")):null}}},5868:(e,t,a)=>{a.d(t,{f:()=>r,I:()=>i});var s=a(7294),n=a(3749);class r extends s.Component{constructor(e){super(e),this.state={editingNode:null,editingName:""}}render(){let e="1px solid #ececec";return s.createElement("div",{style:{marginTop:"1.2em",fontSize:"1em"}},s.createElement("div",{style:{borderTop:e,borderRight:e,borderLeft:e,padding:".2em .5em",backgroundColor:"#f6fbfd"},className:"no-text-select"},s.createElement("span",{style:{cursor:"pointer",marginRight:"1em",color:"#007bff"},onClick:()=>{let e=prompt("请输入新目录名","");e&&this.props.onNewFolder(e)}}," [ 新建目录 ] "),s.createElement("span",{style:{cursor:"pointer",marginRight:"1.5em",color:"#bb651d"},onClick:()=>{let e=prompt(`请输入新${this.props.resourceName}名字`,"");e&&(e=e.trim(),this.props.onNewItem_begin(e))}},"新建",this.props.resourceName),s.createElement("span",{className:"fas fa-sync",style:{cursor:"pointer",marginRight:"1.2em",paddingRight:"1.2em",color:"#007bff",borderRight:"1px solid gray"},onClick:()=>{this.props.data.curFolderContent=[],this.forceUpdate(),this.props.onRefreshFolder()}}," "),["根目录",...this.props.data.curFolderPath].map(((e,t)=>s.createElement("span",{key:t,style:{cursor:"pointer",marginRight:".3em"},onClick:()=>{t!==this.props.data.curFolderPath.length&&this.props.onCurFolderChange(this.props.data.curFolderPath.slice(0,t))}},e+" >")))),s.createElement(n.W4,{id:"MENU_Content",holdToDisplay:1e3},s.createElement("div",{style:{border:e,padding:".5em",minHeight:"10em",maxHeight:"20em",overflow:"auto"}},this.props.data.curFolderContent.map(((e,t)=>s.createElement("div",{className:"fb-node",key:t,style:{},onDoubleClick:"folder"===e.type?()=>this.props.onCurFolderChange([...this.props.data.curFolderPath,e.name]):()=>this.props.onOpenItem(e)},s.createElement(n.W4,{id:"MENU_"+t,holdToDisplay:1e3},s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-3"},s.createElement("span",{className:`${e.iconClass}`}),e==this.state.editingNode?s.createElement("input",{className:"form-control",style:{display:"inline",width:"50%",height:"1.6em"},value:this.state.editingName,onChange:e=>{this.state.editingName=e.target.value,this.forceUpdate()},onKeyDown:t=>{"Enter"==t.key?(this.props.onChangeName(e.name,this.state.editingName,e),this.setState({editingNode:null,editingName:""})):"Escape"==t.key&&this.setState({editingNode:null,editingName:""})}}):s.createElement("span",{className:"fb-node-name"},e.name)),this.customNodeInfo(e))),s.createElement(n.xV,{id:"MENU_"+t},s.createElement(n.sN,{onClick:()=>{this.setState({editingNode:e,editingName:e.name})}},"重命名"),s.createElement(n.sN,{onClick:()=>{confirm(`确定要删除 ${e.name} ？`)&&this.props.onDelete(e)}},"删除"),s.createElement(n.sN,{divider:!0}),s.createElement(n.sN,{onClick:()=>{this.props.data.pasteInfo={sourceFolderPath:this.props.data.curFolderPath,sourceNodes:[e],pasteOp:"copy"}}},"复制"),s.createElement(n.sN,{onClick:()=>{this.props.data.pasteInfo={sourceFolderPath:this.props.data.curFolderPath,sourceNodes:[e],pasteOp:"cut"}}},"剪切"),"file"===e.type?s.createElement(s.Fragment,null,s.createElement(n.sN,{divider:!0}),s.createElement(n.sN,{onClick:()=>{this.props.onModifyItem_begin(e)}},"编辑")):null,this.calcExtraMenu(e))))))),s.createElement(n.xV,{id:"MENU_Content"},s.createElement(n.sN,{onClick:()=>{this.props.data.pasteInfo||aler("没有复制源"),this.props.data.pasteInfo.targetFolderPath=this.props.data.curFolderPath,this.props.onPaste()}},"粘贴")))}calcExtraMenu(e){if(!this.props.extraContextMenuItems)return null;let t=this.props.extraContextMenuItems.map(((t,a,r)=>!t.condition||t.condition(e)?s.createElement(n.sN,{key:a,onClick:()=>{t.onClick(e)}},t.name):null)).filter((e=>null!==e));return 0===t.length?null:s.createElement(s.Fragment,null,s.createElement(n.sN,{divider:!0}),t)}customNodeInfo(e){return this.props.customNodeInfo?this.props.customNodeInfo(e):null}}class i extends s.Component{constructor(e){super(e)}render(){return s.createElement("div",{style:{fontSize:"1em"}},s.createElement("span",{style:{cursor:"pointer",marginRight:"1.5em",color:"#bb651d"},onClick:()=>{let e=this.props.data.curFolderContent.reduce(((e,t)=>("file"===t.type&&e.push(t),e)),[]);this.props.onSelectItems(e)}},"全选"),s.createElement("div",{style:{display:"inline-flex",WebkitUserSelect:"none",fontSize:".95em",color:"#495057"}},["根目录",...this.props.data.curFolderPath].map(((e,t)=>s.createElement("span",{key:t,style:{cursor:"pointer",marginRight:".3em"},onClick:()=>{t!==this.props.data.curFolderPath.length&&this.props.onCurFolderChange(this.props.data.curFolderPath.slice(0,t))}},e+" >")))),s.createElement("div",{style:{marginTop:".1em",border:"1px solid #ececec",padding:"1em",minHeight:"10em",maxHeight:"20em",overflow:"auto"}},this.props.data.curFolderContent.map(((e,t)=>s.createElement("div",{className:"fb-node",key:t,onDoubleClick:"folder"===e.type?()=>this.props.onCurFolderChange([...this.props.data.curFolderPath,e.name]):()=>this.props.onSelectItems([e])},s.createElement("span",{className:`${e.iconClass}`}),s.createElement("span",{className:"fb-node-name"},e.name))))))}}},6837:(e,t,a)=>{var s=a(7294),n=a(3935),r=a(4890),i=a(4494),l=a(3727),o=a(6872);const c=(0,r.UY)({profile:(e=null,t)=>{switch(t.type){case"FETCH_PROFILE_PERMISSION_SUCCESS":case"FETCH_PROFILE_SUCCESS":return t.profile;default:return e}},permissions:(e=[],t)=>{switch(t.type){case"FETCH_PROFILE_PERMISSION_SUCCESS":return t.permissions;default:return e}},nrbs:(e={0:0,1:0,2:0},t)=>{switch(t.type){case"RBS_CHANGED":return t.nrbs;default:return e}}});class m extends s.Component{constructor(e){super(e),this.hash=window.location.hash.split("?")[0].substring(2),o._Y.getUrlParameter("keywords"),this.state={curMenu:this.hash},window.addEventListener("hashchange",(()=>{this.forceUpdate()}))}_genOneMenuItem(e,t,a){if(a.startsWith("http"))return s.createElement("li",{className:"nav-item"},s.createElement("a",{href:a,className:"nav-link"},t));let n=window.location.hash.split("?")[0].slice(1);return s.createElement("li",{className:n===a?"nav-item active":"nav-item"},s.createElement(l.rU,{to:a,className:"nav-link"},t))}render(){return s.createElement("nav",{className:"main-header navbar navbar-expand-md navbar-light",style:{backgroundColor:this.navibarColor}},s.createElement("div",{className:"container"},s.createElement("button",{className:"navbar-toggler order-1 collapsed",type:"button","data-toggle":"collapse","data-target":"#navbarCollapse","aria-controls":"navbarCollapse","aria-expanded":"false","aria-label":"Toggle navigation"},s.createElement("span",{className:"navbar-toggler-icon"})),s.createElement("div",{className:"navbar-collapse order-3 collapse",id:"navbarCollapse",style:{}},s.createElement("ul",{className:"navbar-nav"},s.createElement("img",{src:this.iconUrl,className:"img-circle elevation-3",style:{opacity:".9",margin:".2em 1em 0 0",width:"2em",height:"2em"}}),this.genAllMenuItem())),this.genNavRightPart()))}}const d=(0,i.$j)((e=>({profile:e.profile,permissions:e.permissions,nrbs:e.nrbs})),(e=>({getMyProfile:async()=>{let t=await o._Y.rfetch("get","/api/etc",{action:"getmyprofile",withnrbs:!0});e({type:"FETCH_PROFILE_PERMISSION_SUCCESS",profile:t.profile,permissions:t.permissions}),e({type:"RBS_CHANGED",nrbs:t.nrbs})},nrbsChanged:async t=>{let a=await o._Y.rfetch("post","/api/etc",{action:"setmyringbells",change:t});e({type:"RBS_CHANGED",nrbs:a.nrbs})}})))(class extends m{constructor(e){super(e),this.iconUrl="/assets/images/logo.png",this.navibarColor="#f4f9ff"}componentDidMount(){this.props.getMyProfile()}signout(){sessionStorage.clear(),$.ajax({url:"/api/sign",type:"POST",data:JSON.stringify({action:"signout"}),contentType:"application/json",success:function(e,t,a){window.location.href="/sign.html"},error:function(e,t,a){window.location.href="/sign.html"}})}genAllMenuItem(){return this.props.permissions.includes("common.creator_approve")?s.createElement(s.Fragment,null,this._genOneMenuItem("home","首页","/home"),this._genOneMenuItem("wf_creatorapply_list_forreview","创作权审核","/wf_creatorapply_list_forreview"),this._genOneMenuItem("review","作品审核","/review")):s.createElement(s.Fragment,null,this._genOneMenuItem("home","首页","/home"),this._genOneMenuItem("all_lesson","单课","/all_lesson"),this._genOneMenuItem("all_course","专题","/all_course"),this._genOneMenuItem("news","新闻","/news"),this._genOneMenuItem("search","搜索","/search"),this._genOneMenuItem("news","官网","http://www.byhy.net"))}genNavRightPart(){return s.createElement("ul",{className:"order-1 order-md-3 navbar-nav navbar-no-expand ml-auto"},s.createElement("ul",{className:"navbar-nav ml-auto"},this.props.permissions.includes("common.creator_approve")?null:s.createElement("li",{className:"nav-item dropdown"},s.createElement("a",{className:"nav-link","data-toggle":"dropdown",href:"#","aria-expanded":"true",style:{fontSize:"1.2em"}},s.createElement("i",{className:"far fa-envelope"}),s.createElement("span",{className:"badge badge-danger navbar-badge"},this.props.nrbs.total>0?this.props.nrbs.total:"")),s.createElement("div",{className:"dropdown-menu dropdown-menu-lg dropdown-menu-right",style:{left:"inherit",right:0,minWidth:"15em"}},s.createElement("a",{className:"dropdown-item",onClick:()=>{0!==this.props.nrbs.tasktome&&this.props.nrbsChanged({tasktome:0}),window.location.href="/index.html#/assignment_tome"}},s.createElement("i",{className:"fas fa-tasks mr-2"}),"收到的任务",s.createElement("span",{className:"badge badge-danger float-right",style:{marginTop:".2em",borderRadius:".35rem"}},this.props.nrbs.tasktome>0?this.props.nrbs.tasktome:"")),this.props.permissions.includes("common.creator")?s.createElement(s.Fragment,null,s.createElement("div",{className:"dropdown-divider"}),s.createElement("a",{className:"dropdown-item",onClick:()=>{0!==this.props.nrbs.taskfromme&&this.props.nrbsChanged({taskfromme:0}),window.location.href="/index.html#/assignment_fromme"}},s.createElement("i",{className:"far fa-paper-plane mr-2"}),"发出的任务",s.createElement("span",{className:"badge badge-danger float-right",style:{marginTop:".2em",borderRadius:".35rem"}},this.props.nrbs.taskfromme>0?this.props.nrbs.taskfromme:"")),s.createElement("a",{className:"dropdown-item",onClick:()=>{0!==this.props.nrbs.class&&this.props.nrbsChanged({class:0}),window.location.href="/index.html#/enroll_mgr"}},s.createElement("i",{className:"fas fa-chalkboard mr-2",style:{fontSize:".8em"}}),"学习班报名",s.createElement("span",{className:"badge badge-danger float-right",style:{marginTop:".2em",borderRadius:".35rem"}},this.props.nrbs.class>0?this.props.nrbs.class:""))):null,s.createElement("div",{className:"dropdown-divider"}),s.createElement("a",{className:"dropdown-item",onClick:()=>{0!==this.props.nrbs.system&&this.props.nrbsChanged({system:0}),window.location.href="/index.html#/notification_self"}},s.createElement("i",{className:"far fa-bell mr-2",style:{fontSize:"1.1em"}}),"系统通知",s.createElement("span",{className:"badge badge-danger float-right",style:{marginTop:".2em",borderRadius:".35rem"}},this.props.nrbs.system>0?this.props.nrbs.system:"")))),s.createElement("li",{className:"nav-item dropdown"},s.createElement("a",{className:"nav-link","data-toggle":"dropdown",href:"#"},this.props.profile.avatar?s.createElement("img",{src:this.props.profile.avatar,className:"img-circle",style:{width:"2em",height:"2em"}}):this.props.permissions.includes("common.creator")?s.createElement("i",{className:"fas fa-user-edit"}):s.createElement("i",{className:"far fa-user"}),"  ",this.props.profile.realname),s.createElement("div",{className:"dropdown-menu dropdown-menu-lg dropdown-menu-right"},s.createElement(l.rU,{to:"/profile",className:"dropdown-item"},s.createElement("i",{className:"far fa-user mr-2",style:{color:"#df888f"}}),"  个人信息",s.createElement("span",{className:"float-right text-muted text-sm"},"点击修改")),this.props.permissions.includes("common.creator_approve")?null:s.createElement(s.Fragment,null,s.createElement("div",{className:"dropdown-divider"}),s.createElement(l.rU,{to:"/learn_center",className:"dropdown-item"},s.createElement("i",{className:"fas fa-chalkboard mr-2",style:{fontSize:".8em",color:"#df888f"}}),"  学习中心",s.createElement("span",{className:"float-right text-muted text-sm"},"点击进入"))),this.props.permissions.includes("common.creator")?s.createElement(s.Fragment,null,s.createElement("div",{className:"dropdown-divider"}),s.createElement(l.rU,{to:"/teach_center",className:"dropdown-item"},s.createElement("i",{className:"fas fa-video mr-2",style:{fontSize:"1em",color:"#df888f"}}),"  教学中心",s.createElement("span",{className:"float-right text-muted text-sm"},"点击进入"))):null,s.createElement("div",{className:"dropdown-divider"}),s.createElement("a",{className:"dropdown-item",style:{cursor:"pointer"},onClick:()=>{this.signout()}},s.createElement("i",{className:"fas fa-sign-out-alt mr-2",style:{color:"#df888f"}}),"  退出登录",s.createElement("span",{className:"float-right text-muted text-sm"},"点击退出"))))))}});var p=a(6550);class h extends s.Component{constructor(e){super(e),this.state={activeIdx:0},this.interval=null}componentDidMount(){this.setupLoopShow()}setupLoopShow(){this.interval=setInterval((()=>{let e=this.state.activeIdx+1;e>=this.props.bars.length&&(e=0),this.setState({activeIdx:e})}),4e3)}componentWillUnmount(){this.interval&&clearInterval(this.interval)}render(){return s.createElement("div",{className:"home-slide"},this.props.bars.map(((e,t)=>s.createElement("img",{src:e,key:t,style:{width:"100%",cursor:"pointer",display:this.state.activeIdx===t?"":"none"},onClick:()=>{this.props.clickOne(this.state.activeIdx)}}))),s.createElement("div",{className:"trigger"},this.props.bars.map(((e,t)=>s.createElement("span",{key:t,className:t===this.state.activeIdx?"on":"",onClick:()=>{this.setState({activeIdx:t}),clearInterval(this.interval),this.setupLoopShow()}})))))}}class u extends s.Component{constructor(e){super(e),this.state={homepageinfo:{news:[],banner:[],hot:[]}},this.gethomepagebyconfig=this.gethomepagebyconfig.bind(this),document.title="首页 - 黑羽学院"}componentDidMount(){this.gethomepagebyconfig(),console.log("in Home componentDidMount")}itemComponentStyle_Product(e,t,a){return s.createElement("div",{key:e.id,className:"row",style:{padding:".6em 0",borderBottom:a.length-1===t?"":"1px solid #f4f0e9"}},s.createElement("div",{className:"col-md-4"},s.createElement("a",{target:"_blank",href:`/view_one.html?type=${e.type}&id=${e.id}`},s.createElement("img",{style:{width:"12em"},src:null===e.detail.coverimage?"/assets/images/cover.png":e.detail.coverimage}))),s.createElement("div",{className:"col-md-8"},s.createElement("div",null,s.createElement("span",null,e.detail.name)),s.createElement("div",{style:{marginTop:"1em",color:"#99a2aa"}},s.createElement("span",{style:{marginRight:"1em"}},e.detail.creator_name)),s.createElement("div",{style:{marginTop:"1em",color:"#99a2aa"}},s.createElement("span",{style:{marginRight:"4em"}},s.createElement("i",{className:"far fa-thumbs-up"}),"   ",e.detail.thumbupcount),s.createElement("span",{style:{marginRight:"4em"}},s.createElement("i",{className:"far fa-star"}),"   ",e.detail.favorcount),"0"===e.price?null:s.createElement("span",{style:{marginRight:"4em"}},s.createElement("i",{className:"fas fa-yen-sign"}),"   ",e.detail.price))))}itemComponentStyle_Article(e,t,a){return s.createElement("div",{key:e.id,className:"row",style:{padding:".6em 0",borderBottom:a.length-1===t?"":"1px solid #f4f0e9",color:"gray",cursor:"pointer"},onClick:()=>window.open(`/view_one.html?type=${e.type}&id=${e.id}`,"_blank")},e.detail.name)}render(){return s.createElement(s.Fragment,null,s.createElement("img",{src:"/assets/images/banner.jpg",style:{width:"100%",height:"14vw",minHeight:"8em",maxHeight:"14em",marginTop:"-1em"}}),s.createElement("div",{className:"row",style:{marginTop:".5em"}},s.createElement("div",{className:"col-lg-7"},s.createElement("div",{className:"card"},s.createElement("div",{className:"card-header bg-light"},s.createElement("h3",{className:"card-title"},"热门课程"),s.createElement("div",{className:"card-tools"},s.createElement("button",{type:"button",className:"btn btn-tool",onClick:()=>{window.location.href="/index.html#/all_lesson"}},"更多"))),s.createElement("div",{className:"card-body"},this.state.homepageinfo.hot.map(((e,t,a)=>this.itemComponentStyle_Product(e,t,a)))))),s.createElement("div",{className:"col-lg-5"},s.createElement("div",null," ","推荐课程 >>>"," "),0===this.state.homepageinfo.banner.length?null:s.createElement(h,{bars:this.state.homepageinfo.banner.map((e=>null===e.detail.coverimage?"/assets/images/cover.png":e.detail.coverimage)),clickOne:e=>{let t=this.state.homepageinfo.banner[e];window.open(`/view_one.html?type=${t.type}&id=${t.id}`,"_blank")}}),s.createElement("div",{className:"card",style:{marginTop:"1em"}},s.createElement("div",{className:"card-header bg-light"},s.createElement("h3",{className:"card-title"},"新闻动态"),s.createElement("div",{className:"card-tools"},s.createElement("button",{type:"button",className:"btn btn-tool",onClick:()=>{window.location.href="/index.html#/news"}},"更多"))),s.createElement("div",{className:"card-body"},this.state.homepageinfo.news.map(((e,t,a)=>this.itemComponentStyle_Article(e,t,a))))))))}gethomepagebyconfig(){o._Y.ajax_get("/api/config",{action:"gethomepagebyconfig"},(e=>{this.setState({homepageinfo:e.info})}))}}class g extends s.Component{constructor(e){super(e),this.state={searchKeywords:"",curSearch:"search_user",items:[]},this.lastSearchKeywords="",this.searchState=0,document.title="搜索创作者 - 黑羽学院"}componentDidMount(){console.log("in Search::componentDidMount")}async searchFunc(){if(this.state.searchKeywords=this.state.searchKeywords.trim(),0===this.state.searchKeywords.length)return;this.searchState=1;let e=await o._Y.rfetch("get","/api/etc",{action:this.state.curSearch,keywords:this.state.searchKeywords});this.lastSearchKeywords=this.state.searchKeywords,this.searchState=2,this.setState({items:e.items})}render(){return s.createElement(s.Fragment,null,s.createElement("div",{className:"input-group mb-3 input-group-sm",style:{maxWidth:"20em",marginRight:"1em",margin:".5em auto"}},s.createElement("input",{type:"text",className:"form-control",placeholder:"输入创作者名字搜索",value:this.state.searchKeywords,onChange:e=>{this.setState({searchKeywords:e.target.value})},onKeyPress:e=>{"Enter"===e.key&&this.lastSearchKeywords!=this.state.searchKeywords&&this.searchFunc()}}),s.createElement("span",{className:"input-group-append"},s.createElement("button",{className:"btn btn-default btn-flat",onClick:e=>{this.lastSearchKeywords!=this.state.searchKeywords&&this.searchFunc()}},s.createElement("i",{className:"fa fa-search",style:{color:"#8dc2dc"}})))),s.createElement("div",{className:"row",style:{marginTop:"0em"}},s.createElement("div",{className:"col-12"},s.createElement("div",{className:"tab-content"},this.genResult()))))}genResult(){return this.state.items.length>0?this.state.items.map(((e,t,a)=>s.createElement("div",{className:"row search-result-item-2",key:e.id,style:{borderBottom:a.length-1===t?"":"1px solid #f4f0e9",textAlign:"center",color:"#10a0b7"}},s.createElement("div",{className:"col-md-2"},s.createElement("img",{src:e.avatar?e.avatar:"/assets/images/avatar.png",onClick:()=>{window.open("/index.html?#/creator?uid="+e.id,"_blank")},style:{width:"5em",cursor:"pointer",borderRadius:"50%"}})),s.createElement("div",{className:"col-md-3"},s.createElement("div",null,s.createElement("span",{style:{cursor:"pointer",fontSize:"1em",color:"gray"},onClick:()=>{window.open("/index.html?#/creator?uid="+e.id,"_blank")}},e.realname)),s.createElement("span",{style:{fontSize:".9em",marginRight:".8em"}},"粉丝: ",e.followedcount),s.createElement("span",{style:{fontSize:".9em",marginRight:".8em"}},"点赞: ",e.thumbups),s.createElement("span",{style:{fontSize:".9em"}},"收藏: ",e.favorites),s.createElement("br",null),e.myself?s.createElement("span",{style:{marginLeft:"0"}},"我自己"):s.createElement(s.Fragment,null,e.myteacher?s.createElement("span",{style:{marginLeft:"0"}},"我的老师"):null,e.mystudent?s.createElement("span",{style:{marginLeft:"0"}},"我的学生"):null)),s.createElement("div",{className:"col-md-7 text-left"},s.createElement("p",{style:{whiteSpace:"pre-wrap",color:"gray"}},e.desc.length>50?e.desc.slice(0,50)+"...":e.desc))))):2===this.searchState?s.createElement("h5",{style:{marginTop:"1em"}}," 没有找到    "):1===this.searchState?s.createElement("h5",{style:{marginTop:"1em"}}," 搜索中...    "):null}}let f={0:"已下发",1:"草稿",2:"已提交",3:"已完成",4:"待改进"},y={0:"待审核",1:"审核通过",2:"审核不通过"},E={1:"学习中",2:"已毕业",3:"暂停学习"};var v=a(1090),_=a(5868),b=a(7632);class w extends s.Component{constructor(e){super(e),this.treeCache={},this.filebrowserData={curFolderPath:[],curFolderContent:[],pasteInfo:null},this.editOneData={show:!1,action:"add",resourceName:"",title:"",fields:[]}}refreshCurFolder(){this.setCurFolder(this.filebrowserData.curFolderPath,!1)}async updateFolderFromServer(e){let t=await o._Y.rfetch("post","/api/folder",{action:"getfoldercontent",foldertype:this.props.foldertype,folderpath:e}),a=e.join("/");return this.treeCache[a]=t.content,t.content}async setCurFolder(e,t=!0){let a=null,s=e.join("/");a=t&&this.treeCache.hasOwnProperty(s)?this.treeCache[s]:await this.updateFolderFromServer(e),a=Object.keys(a).sort().reduce(((e,t)=>(e[t]=a[t],e)),{});let n=this.filebrowserData.curFolderContent=[];for(const[e,t]of Object.entries(a))t.hasOwnProperty("id")||n.push({type:"folder",iconClass:"fb-node-icon-folder far fa-folder",name:e});for(const[e,t]of Object.entries(a))t.hasOwnProperty("id")&&n.push({type:"file",iconClass:"fb-node-icon-file far fa-file",name:e,id:t.id,info:t.info});this.filebrowserData.curFolderPath=e,this.forceUpdate()}componentDidMount(){this.refreshCurFolder()}render(){return s.createElement(s.Fragment,null,s.createElement(_.f,{viewOnly:this.props.viewOnly,resourceName:this.props.resourceName,data:this.filebrowserData,onRefreshFolder:()=>{this.refreshCurFolder()},onCurFolderChange:e=>{this.setCurFolder(e)},onNewFolder:async e=>{await o._Y.rfetch("post","/api/folder",{action:"addfolder",foldertype:this.props.foldertype,folderpath:this.filebrowserData.curFolderPath,newfoldername:e}),this.filebrowserData.curFolderContent.splice(0,0,{type:"folder",iconClass:"far fa-folder",name:e}),this.forceUpdate(),this.refreshCurFolder()},onChangeName:async(e,t,a)=>{a.name=t,this.forceUpdate(),await o._Y.rfetch("put","/api/folder",{action:"changename",foldertype:this.props.foldertype,folderpath:this.filebrowserData.curFolderPath,oldName:e,newName:t}),this.refreshCurFolder()},onDelete:async e=>{await o._Y.rfetch("delete","/api/folder",{action:"deletenode",foldertype:this.props.foldertype,folderpath:this.filebrowserData.curFolderPath,itemname:e.name}),this.refreshCurFolder()},onNewItem_begin:async e=>{for(let t of this.filebrowserData.curFolderContent)if(t.name===e)return void alert("同名资源已经存在");this.editOneData.show=!0,this.editOneData.action="add",this.editOneData.title=`添加 ${this.props.resourceName} : ${e}`,this.editOneData.resourceName=e,this.editOneData.fields=this.props.createFieldsWhenAddOne(),this.forceUpdate()},onModifyItem_begin:async e=>{this.editOneData.fields=await this.props.createFieldsWhenModifyOne(e.id),this.editOneData._ofields=JSON.parse(JSON.stringify(this.editOneData.fields)),this.editOneData.id=e.id,this.editOneData.show=!0,this.editOneData.action="edit",this.editOneData.title=`修改 ${this.props.resourceName} : ${e.name}`,this.forceUpdate()},onOpenItem:e=>{window.open(`/view_one.html?type=${this.props.foldertype}&id=${e.id}`,"_blank")},onPaste:async()=>{let e=this.filebrowserData.pasteInfo;e&&(await o._Y.rfetch("put","/api/folder",{action:"paste",foldertype:this.props.foldertype,sourceFolderPath:e.sourceFolderPath,sourceNodes:e.sourceNodes.map((e=>({name:e.name,type:e.type}))),targetFolderPath:e.targetFolderPath,pasteOp:e.pasteOp}),"cut"===e.pasteOp&&await this.updateFolderFromServer(e.sourceFolderPath),this.refreshCurFolder())},extraContextMenuItems:this.props.extraContextMenuItems,customNodeInfo:this.props.customNodeInfo}),s.createElement(b.Z,{data:this.editOneData,onEditOK:async(e,t)=>{if("add"===this.editOneData.action){let t=(await o._Y.rfetch("post",this.props.resourceUrl,{action:"addone",data:e})).id;await o._Y.rfetch("post","/api/folder",{action:"additem",foldertype:this.props.foldertype,folderpath:this.filebrowserData.curFolderPath,newitemname:this.editOneData.resourceName,newitemid:t})}else{let a={},s=Object.getOwnPropertyNames(e);for(let n of s)this.props.modifyExtraHandle&&this.props.modifyExtraHandle(t,a,e,n)||("categorytags"!==n?e[n]!=t[n]&&(a[n]=e[n]):JSON.stringify(e.categorytags)!=JSON.stringify(t.categorytags)&&(a[n]=e[n]));0===Object.keys(a).length?alert("没有修改任何数据"):(await o._Y.rfetch("put",this.props.resourceUrl,{action:"modifyone",id:this.editOneData.id,newdata:a}),alert(`修改${this.props.resourceName}成功`))}this.editOneData.show=!1,this.refreshCurFolder()}}))}}class N extends s.Component{constructor(e){super(e),this.state={hide:!0,title:"",value:""},this.show=this.show.bind(this),this.props.upInf.show=this.show}show(e="备注",t=""){this.state.title=e,this.state.value=t,this.state.hide=!1,this.forceUpdate()}render(){return this.state.hide?null:s.createElement("div",{className:"modal fade show",style:{display:"block",paddingRight:"17px",backgroundColor:"#17171661"}},s.createElement("div",{className:"modal-dialog"},s.createElement("div",{className:"modal-content"},s.createElement("div",{className:"modal-header"},s.createElement("h4",{className:"modal-title"},this.state.title),s.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",onClick:()=>{this.state.hide=!0,this.forceUpdate()}},s.createElement("span",{"aria-hidden":"true"},"×"))),s.createElement("div",{className:"modal-body"},s.createElement("textarea",{className:"form-control",value:this.state.value,onChange:e=>{this.state.value=e.target.value,this.forceUpdate()}})),s.createElement("div",{className:"modal-footer justify-content-between"},s.createElement("button",{type:"button",className:"btn btn-default","data-dismiss":"modal",onClick:()=>{this.state.hide=!0,this.forceUpdate()}},"取消"),s.createElement("button",{type:"button",className:"btn btn-default",onClick:()=>{this.state.hide=!0,this.forceUpdate(),this.props.upInf.submitFunc(this.state.value)}},"提交")))))}}class x extends s.Component{constructor(e){super(e),this.state={hide:!0,title:"",value:""},this.show=this.show.bind(this)}show(e="",t=""){this.state.title=e,this.state.value=t,this.state.hide=!1,this.forceUpdate()}render(){return this.state.hide?null:s.createElement("div",{className:"toasts-top-right fixed",style:{minWidth:"200px"}},s.createElement("div",{className:"toast fade show",role:"alert"},s.createElement("div",{className:"toast-header"},s.createElement("strong",{className:"mr-auto"},this.state.title),s.createElement("button",{type:"button",className:"ml-2 mb-1 close","aria-label":"Close"},s.createElement("span",{"aria-hidden":"true",onClick:()=>{this.state.hide=!0,this.forceUpdate()}},"×"))),s.createElement("div",{className:"toast-body"},this.state.value)))}}class C extends s.Component{constructor(e){super(e),document.title="新闻 - 黑羽学院",this.customListItem=this.customListItem.bind(this),this.searchBoxHint="标题名/作者 关键字搜索"}customListItem(e,t,a){return s.createElement("div",{key:e.id,className:"search-result-item-2",style:{borderBottom:a.length-1===t?"":"1px solid #f4f0e9",cursor:"pointer",color:"#99a2aa"},onClick:()=>{window.open(`/view_one.html?type=news&id=${e.id}`,"_blank")}},s.createElement("div",{className:"col-md-4 text-left"},s.createElement("img",{src:null===e.coverimage?"/assets/images/cover.png":e.coverimage,style:{width:"11em"}})),s.createElement("div",{className:"col-md-4 text-left"},s.createElement("div",{style:{marginTop:"1.3em",color:"#206596",fontSize:"1.05em"}},s.createElement("span",null,e.name))),s.createElement("div",{className:"col-md-4 text-center"},s.createElement("div",{style:{marginTop:".5em"}},s.createElement("span",null,e.creator_name)),s.createElement("div",{style:{marginTop:".5em"}},s.createElement("span",null,UTCTimeString2Local(e.createtime).slice(0,10)))))}render(){return s.createElement(v.B,{searchBoxHint:this.searchBoxHint,resourceUrl:"/api/news",listbypage_extraPara:{withoutcontent:!0},customListItem:this.customListItem})}}class k extends s.Component{constructor(e){super(e),document.title="学习班管理 - 黑羽学院",this.ref_toast=s.createRef(),this.pageviewRef=s.createRef(),this.searchBoxHint="班名 关键字搜索"}async listCourse(e){return(await o._Y.rfetch("get","/api/course",{action:"listbypage_onlymine",pagenum:1,pagesize:20,keywords:e,fields:"id,name"})).items}render(){return s.createElement(s.Fragment,null,s.createElement(x,{ref:this.ref_toast}),s.createElement(v.C,{ref:this.pageviewRef,resourceName:"学习班",resourceUrl:"/api/sclass",listbypage_extraPara:{action:"listbypage_onlymine",withoutcontent:!0},searchBoxHint:this.searchBoxHint,addone_fields:[{name:"班名",attr:"name",type:"OneLineText",value:"",check_string_len:[2,100]},{name:"封面",attr:"coverimage",type:"SingleImg",value:null,imageStyle:{width:"20em"}},{name:"价格",attr:"price",type:"OneLineText",value:"0",check_int_range:[0,999999]},{name:"介绍",attr:"content",type:"RichTextEditWithUploader",value:"",check_string_len:[1,5e5]},{name:"学习资料",attr:"learningstuff",type:"ListSelectWithSort",value:[],displayAttr:"name",searchfunc:async e=>await this.listCourse(e)}],customListItem:(e,t,a)=>s.createElement("div",{key:e.id,className:"search-result-item-2",style:{borderBottom:a.length-1===t?"":"1px solid #f4f0e9",textAlign:"center",color:"#10a0b7"}},s.createElement("div",{className:"col-md-2"},s.createElement("a",{target:"_blank",style:{cursor:"pointer",marginRight:"0"},onClick:()=>{window.open(`/view_one.html?type=sclass&id=${e.id}`,"_blank")}},s.createElement("img",{src:null===e.coverimage?"/assets/images/cover.png":e.coverimage,style:{width:"10em"}}))),s.createElement("div",{className:"col-md-4",style:{cursor:"pointer"},onClick:()=>{window.open(`/view_one.html?type=sclass&id=${e.id}`,"_blank")}},s.createElement("div",{style:{margin:".5em 0"}},s.createElement("span",null,e.name)),s.createElement("div",null,s.createElement("span",null,UTCTimeString2Local(e.createtime).slice(0,10)))),s.createElement("div",{className:"col-md-1",style:{}},s.createElement("div",{style:{margin:".5em 0"}},s.createElement("span",{style:{color:"#fd7504",fontSize:"1em"}},"￥",e.price)),s.createElement("div",{style:{cursor:"pointer"},title:"报名人数",onClick:()=>window.open(`index.html#/enroll_mgr?sclass_id=${e.id}`)},s.createElement("span",null,s.createElement("i",{className:"far fa-user"}),"  ",e.enrolls))),s.createElement("div",{className:"col-md-5",style:{marginTop:"1em"}},s.createElement("button",{className:"btn btn-sm",style:{marginRight:".5em",color:"gray"},onClick:()=>{this.ref_toast.current.show("邀请码",null===e.applysns?"":e.applysns.join(" , "))}},"查看邀请码"),s.createElement("button",{className:"btn btn-sm",style:{marginRight:".5em",color:"gray"},onClick:async()=>{let t=await o._Y.rfetch("post","/api/sclass",{action:"addmoreapplysns",id:e.id});e.applysns=t.applysns,alert("邀请码添加成功")}},"添加邀请码"),s.createElement("button",{className:"btn btn-sm",style:{marginRight:".5em",color:"gray"},onClick:async()=>{let t=await o._Y.rfetch("get","/api/sclass",{action:"getone",id:e.id});e.content=t.rec.content,e.learningstuff=t.rec.learningstuff,e._editing_data=[{name:"标题",attr:"name",type:"OneLineText",value:e.name,check_string_len:[2,100]},{name:"封面",attr:"coverimage",type:"SingleImg",value:e.coverimage,imageStyle:{width:"20em"}},{name:"价格",attr:"price",type:"OneLineText",value:e.price,check_int_range:[0,1e5]},{name:"介绍",attr:"content",type:"RichTextEditWithUploader",value:e.content,check_string_len:[1,5e5]},{name:"学习资料",attr:"learningstuff",type:"ListSelectWithSort",value:JSON.parse(JSON.stringify(e.learningstuff)),displayAttr:"name",searchfunc:async e=>await this.listCourse(e)}],e._editing=!0,this.pageviewRef.current.forceUpdate()}},"编辑"),s.createElement("button",{className:"btn btn-sm",style:{marginRight:".5em",color:"gray"},onClick:()=>{this.pageviewRef.current.onDeleteOne(e.id)}},"删除")))}))}}class S extends s.Component{constructor(e){super(e),document.title="他的学习班 - 黑羽学院",this.customListItem=this.customListItem.bind(this),this.searchBoxHint="班名 关键字搜索"}customListItem(e,t,a){return s.createElement("div",{key:e.id,className:"search-result-item-2",style:{borderBottom:a.length-1===t?"":"1px solid #f4f0e9",textAlign:"center",color:"#6c757d"}},s.createElement("div",{className:"col-md-3"},s.createElement("a",{target:"_blank",style:{cursor:"pointer",marginRight:"0"},onClick:()=>{window.open(`/view_one.html?type=sclass&id=${e.id}`,"_blank")}},s.createElement("img",{src:null===e.coverimage?"/assets/images/cover.png":e.coverimage,style:{width:"10em"}}))),s.createElement("div",{className:"col-md-4"},"0"===e.price?null:s.createElement("div",{style:{margin:".5em 0"}},s.createElement("span",{style:{color:"#ff7501",fontSize:"1em"}},"￥",e.price)),s.createElement("div",null,s.createElement("span",null,e.name))),s.createElement("div",{className:"col-md-3",style:{}},s.createElement("div",{style:{margin:".5em 0"}},s.createElement("span",null,UTCTimeString2Local(e.createtime).slice(0,10))),s.createElement("div",{style:{}},s.createElement("span",null,s.createElement("i",{className:"far fa-user"}),"  ",e.enrolls))),s.createElement("div",{className:"col-md-2",style:{marginTop:"2em"}},e.userstate.includes("enrolled")?s.createElement("span",{style:{color:"#03a9f4"}},"已报名"):s.createElement("span",{style:{color:"#03a9f4",cursor:"pointer"},onClick:async()=>{let t=prompt("请输入报名邀请码","");t&&(await o._Y.rfetch("post","/api/enroll",{action:"enrollapply",sclassid:e.id,applysn:t,desc:"报名信息描述"}),alert("报名成功"),e.enrolls+=1,e.userstate="enrolled",this.forceUpdate())}},"  报名 ")))}render(){return s.createElement(v.B,{searchBoxHint:this.searchBoxHint,resourceUrl:"/api/sclass",listbypage_extraPara:{withoutcontent:!0,withuserstate:!0,creatorid:this.props.uid},customListItem:this.customListItem})}}class I extends s.Component{constructor(e){super(e),document.title="报名情况 - 黑羽学院",this.customListItem=this.customListItem.bind(this),this.sclass_id=o._Y.getUrlParameter("sclass_id"),this.searchBoxHint="学员名/班名 关键字搜索"}componentDidUpdate(e){let t=o._Y.getUrlParameter("sclass_id");this.sclass_id!==t&&(this.sclass_id=t,this.forceUpdate())}customListItem(e,t,a){return s.createElement("div",{key:e.id,className:"search-result-item-2",style:{borderBottom:a.length-1===t?"":"1px solid #f4f0e9",textAlign:"center",color:"#6c757d"}},s.createElement("div",{className:"col-md-3"},s.createElement("a",{target:"_blank",style:{cursor:"pointer",marginRight:"0"},onClick:()=>{window.open(`/view_one.html?type=sclass&id=${e.sclass_id}`,"_blank")}},s.createElement("span",null,e.sclass_name))),s.createElement("div",{className:"col-md-1 text-center"},s.createElement("div",null,s.createElement("span",{style:{color:"#ff7501",fontSize:"1em"}},"￥",e.fee))),s.createElement("div",{className:"col-md-2 text-center"},s.createElement("div",null,s.createElement("span",{style:{color:1===e.status?"gray":"#ff7501",fontSize:"1em"}},E[e.status]))),s.createElement("div",{className:"col-md-3",style:{}},s.createElement("div",null,s.createElement("span",null,UTCTimeString2Local(e.enrolltime).slice(0,19)))),s.createElement("div",{className:"col-md-3"},s.createElement("span",{style:{cursor:"pointer",color:"#03a9f4"},onClick:()=>{window.open(`/index.html#/student?uid=${e.student_id}`,"_blank")}},e.student_name)))}render(){return s.createElement(v.B,{searchBoxHint:this.searchBoxHint,pageSize:10,resourceUrl:"/api/enroll",listbypage_extraPara:{action:"listbypage_teacherview",sclass_id:this.sclass_id,withoutcontent:!0},customListItem:this.customListItem})}}class O extends s.Component{constructor(e){super(e),document.title="我报名的班 - 黑羽学院",this.customListItem=this.customListItem.bind(this),this.sclass_id=o._Y.getUrlParameter("sclass_id"),this.searchBoxHint="班名 关键字搜索"}componentDidUpdate(e){let t=o._Y.getUrlParameter("sclass_id");this.sclass_id!==t&&(this.sclass_id=t,this.forceUpdate())}customListItem(e,t,a){return s.createElement("div",{key:e.id,className:"search-result-item-2",style:{borderBottom:a.length-1===t?"":"1px solid #f4f0e9",textAlign:"center",color:"#6c757d"}},s.createElement("div",{className:"col-md-3"},s.createElement("a",{target:"_blank",style:{cursor:"pointer",color:"#03a9f4"},onClick:()=>{window.open(`/view_one.html?type=sclass&id=${e.sclass_id}`,"_blank")}},s.createElement("span",null,e.sclass_name))),s.createElement("div",{className:"col-md-2"},s.createElement("span",{style:{cursor:"pointer",color:"#03a9f4"},onClick:()=>{window.open(`/index.html#/creator?uid=${e.teacher_id}`,"_blank")}},e.teacher_name)),s.createElement("div",{className:"col-md-2 text-center"},s.createElement("div",null,s.createElement("span",{style:{color:"#ff7501",fontSize:"1em"}},"￥",e.fee))),s.createElement("div",{className:"col-md-2 text-center"},s.createElement("div",null,s.createElement("span",{style:{color:1===e.status?"gray":"#ff7501",fontSize:"1em"}},E[e.status]))),s.createElement("div",{className:"col-md-3",style:{}},s.createElement("div",null,s.createElement("span",null,UTCTimeString2Local(e.enrolltime).slice(0,19)))))}render(){return s.createElement(v.B,{searchBoxHint:this.searchBoxHint,pageSize:10,resourceUrl:"/api/enroll",listbypage_extraPara:{action:"listbypage_studentview",sclass_id:this.sclass_id,withoutcontent:!0},customListItem:this.customListItem})}}class T extends s.Component{constructor(e){super(e),document.title="系统通知 - 黑羽学院",this.customListItem=this.customListItem.bind(this)}customListItem(e,t,a){let n=e.content.color?e.content.color:"gray";return s.createElement("div",{key:e.id,className:"search-result-item-2",style:{borderBottom:a.length-1===t?"":"1px solid #f4f0e9",color:"#6c757d"}},s.createElement("div",{className:"col-md-3 text-center"},s.createElement("div",null,s.createElement("span",{style:{color:n,marginTop:"0em"}},e.title)),s.createElement("div",{style:{marginTop:".5em"}},s.createElement("span",null,UTCTimeString2Local(e.time).slice(0,16)))),s.createElement("div",{className:"col-md-6"},s.createElement("div",{style:{marginTop:"0"}},s.createElement("p",{style:{whiteSpace:"pre"}},e.content.desc))),s.createElement("div",{className:"col-md-3 text-left"},e.content.link?s.createElement("div",{style:{marginTop:"1em"}},s.createElement("a",{href:e.content.link,target:"_blank"},"查看")):null))}render(){return s.createElement(v.B,{withoutSearchBox:!0,pageSize:10,resourceUrl:"/api/notification",customListItem:this.customListItem})}}class U extends s.Component{constructor(e){super(e),document.title="任务管理 - 黑羽学院",this.state={taskNodeToAssign:null},this.editOneData_taskassign={show:!1,title:"分派任务",fields:[{name:"选择学生",attr:"students",type:"MultiSelectWithKeywords",value:[],maxnum:1e3,optionname:"studentname",optionvalue:"studentid",searchfunc:async e=>(await o._Y.rfetch("post","/api/sclass",{action:"getstudents",keywords:e,scid:null})).students}]}}render(){return s.createElement(s.Fragment,null,s.createElement(w,{resourceName:"学习任务",resourceUrl:"/api/task",foldertype:"task",createFieldsWhenAddOne:()=>[{name:"名字",attr:"name",type:"OneLineText",value:"",check_string_len:[2,100]},{name:"任务内容",attr:"content",type:"RichTextEditWithUploader",value:"",check_string_len:[1,5e4]}],createFieldsWhenModifyOne:async e=>{let t=(await o._Y.rfetch("get","/api/task",{action:"getone",id:e})).rec;return[{name:"名字",attr:"name",type:"OneLineText",value:t.name,check_string_len:[2,100]},{name:"任务内容",attr:"content",type:"RichTextEditWithUploader",value:t.content,check_string_len:[1,5e4]}]},extraContextMenuItems:[{name:"分派任务",condition:e=>"file"===e.type,onClick:e=>{this.editOneData_taskassign.show=!0,this.editOneData_taskassign.title=`分派任务：${e.name}`,this.setState({taskNodeToAssign:e})}}]}),s.createElement(b.Z,{data:this.editOneData_taskassign,onEditOK:async e=>{await o._Y.rfetch("post","/api/assignment",{action:"assign",tasks:[this.state.taskNodeToAssign.id],desc:e.desc,students:e.students}),this.editOneData_taskassign.show=!1,this.forceUpdate()}}))}}class P extends s.Component{constructor(e){super(e),document.title="任务分派 - 黑羽学院",this.searchBoxHint="标题名/学员名 关键字搜索"}customListItem(e,t,a){return s.createElement("div",{key:e.id,className:"search-result-item-2",style:{cursor:"pointer",borderBottom:a.length-1===t?"":"1px solid #f4f0e9",color:"gray"},onClick:()=>{window.open(`/view_one.html?type=assignment_fromme&id=${e.id}`,"_blank")}},s.createElement("div",{className:"col-md-2"},s.createElement("span",{style:{color:2===e.state?"#c51f2f":3===e.state?"gray":"#03a9f4"}},f[e.state])),s.createElement("div",{className:"col-md-2"},s.createElement("div",{onClick:()=>{window.open(`/index.html#/student?uid=${e.receiver_id}`,"_blank")}},s.createElement("span",{style:{marginRight:"1em"}},e.receiver_name))),s.createElement("div",{className:"col-md-3"},s.createElement("span",null,UTCTimeString2Local(e.assigntime).slice(0,16))),s.createElement("div",{className:"col-md-5",style:{cursor:"pointer"}},e.name))}render(){return s.createElement(v.B,{searchBoxHint:this.searchBoxHint,pageSize:20,resourceUrl:"/api/assignment",listbypage_extraPara:{action:"listbypage_fromme",receiverid:this.props.receiverid?this.props.receiverid:null},customListItem:this.customListItem})}}class F extends s.Component{constructor(e){super(e),document.title="我的任务 - 黑羽学院",this.searchBoxHint="标题名 关键字搜索"}customListItem(e,t,a){return s.createElement("div",{key:e.id,className:"search-result-item-2",style:{cursor:"pointer",borderBottom:a.length-1===t?"":"1px solid #f4f0e9",color:"gray"},onClick:()=>{window.open(`/view_one.html?type=assignment_tome&id=${e.id}`,"_blank")}},s.createElement("div",{className:"col-md-2"},s.createElement("span",{style:{color:0===e.state|4===e.state?"#c51f2f":3===e.state?"gray":"#03a9f4"}},f[e.state])),s.createElement("div",{className:"col-md-2"},s.createElement("div",null,s.createElement("span",{style:{marginRight:"1em"}},e.creator_name))),s.createElement("div",{className:"col-md-3"},s.createElement("span",null,UTCTimeString2Local(e.assigntime).slice(0,16))),s.createElement("div",{className:"col-md-5"},e.name))}render(){return s.createElement(v.B,{searchBoxHint:this.searchBoxHint,pageSize:20,resourceUrl:"/api/assignment",listbypage_extraPara:{action:"listbypage_tome"},customListItem:this.customListItem})}}let L={1:"lesson",2:"course"},A={1:"单课",2:"专题"};class D extends s.Component{constructor(e){super(e),this.state={curMenu:this.props.curMenu}}render(){return s.createElement(s.Fragment,null,s.createElement("ul",{className:"nav nav-tabs"},this.props.menus.map((e=>s.createElement("li",{key:e.name,className:"nav-item",style:{cursor:"pointer"}},s.createElement("a",{className:"nav-link "+(this.state.curMenu===e.name?"active":""),onClick:()=>{this.setState({curMenu:e.name})}},e.title))))),s.createElement("div",{style:{marginTop:"1em"}},this.props.menus.map((e=>{const t=e.component;return this.state.curMenu===e.name?s.createElement(t,{key:e.name}):null}))))}}class R extends s.Component{constructor(e){super(e),this.listbypage_extraPara={withoutcontent:!0},this.searchBoxHint="标题名/作者 关键字搜索",this.customListItem=this.customListItem.bind(this)}customListItem(e,t,a){return s.createElement("div",{key:e.id,className:"search-result-item-2",style:{borderBottom:a.length-1===t?"":"1px solid #f4f0e9"}},s.createElement("div",{className:"col-md-3"},s.createElement("a",{target:"_blank",href:`/view_one.html?type=${this.type}&id=${e.id}`,style:{marginRight:"0"}},s.createElement("img",{src:null===e.coverimage?"/assets/images/cover.png":e.coverimage,style:{width:"12em",height:"6.75em"}}))),s.createElement("div",{className:"col-md-6 text-center"},s.createElement("div",{style:{marginTop:".5em"}},s.createElement("span",null,e.name)),s.createElement("div",{style:{marginTop:"1em",color:"#99a2aa"}},s.createElement("span",{style:{marginRight:"2em"}},s.createElement("i",{className:"far fa-thumbs-up"}),"   ",e.thumbupcount),s.createElement("span",{style:{marginRight:"0em"}},s.createElement("i",{className:"far fa-star"}),"   ",e.favorcount)),s.createElement("div",{style:{marginTop:".5em",color:"#99a2aa"}},s.createElement("span",null,UTCTimeString2Local(e.createtime).slice(0,10)))),"creatorinfo"===this.props.without?null:s.createElement("div",{className:"col-md-3 text-center",style:{cursor:"pointer"},onClick:()=>{window.open("/index.html?#/creator?uid="+e.creator_id,"_blank")}},s.createElement("div",{style:{marginTop:"1em",color:"#99a2aa"}},s.createElement("img",{style:{width:"3em",borderRadius:"50%"},src:e.creator_avatar?e.creator_avatar:"/assets/images/avatar.png"})),s.createElement("div",{style:{marginTop:"1em",color:"#99a2aa"}},s.createElement("span",{style:{marginRight:"0",cursor:"pointer"}},e.creator_name))))}async purchasedClicked(e){await o._Y.rfetch("post","/api/purchase",{action:"purchase_start",producttype:this.type,productid:e.id}),this.forceUpdate()}render(){return s.createElement(v.B,{pageSize:5,searchBoxHint:this.searchBoxHint,resourceUrl:this.resourceUrl,listbypage_extraPara:this.listbypage_extraPara,searchBoxHint:this.searchBoxHint,customListItem:this.customListItem,display_category_tag:this.display_category_tag})}}class B extends R{constructor(e){super(e),this.type="lesson",this.resourceName="课程",this.resourceUrl="/api/lesson",this.display_category_tag=!0,document.title="单课 - 黑羽学院"}}class M extends R{constructor(e){super(e),this.type="course",this.resourceName="专辑",this.resourceUrl="/api/course",this.display_category_tag=!0,document.title="专题 - 黑羽学院"}}class H extends B{constructor(e){super(e),this.listbypage_extraPara={action:"listbypage_somebody",targetuserid:this.props.uid,withoutcontent:!0},document.title="他的单课 - 黑羽学院",this.searchBoxHint="标题名 关键字搜索"}}class W extends M{constructor(e){super(e),this.listbypage_extraPara={action:"listbypage_somebody",targetuserid:this.props.uid,withoutcontent:!0},document.title="他的专题 - 黑羽学院",this.searchBoxHint="标题名 关键字搜索"}}class Y extends s.Component{constructor(e){super(e),this.listbypage_extraPara={action:"listmyfavoritebypage",withoutcontent:!0},this.customListItem=this.customListItem.bind(this),document.title="我的收藏 - 黑羽学院"}customListItem(e,t,a){return s.createElement("div",{key:e.id,className:"search-result-item-2",style:{borderBottom:a.length-1===t?"":"1px solid #f4f0e9"}},s.createElement("div",{className:"col-md-3"},s.createElement("a",{target:"_blank",href:`/view_one.html?type=${L[e.producttypeid]}&id=${e.productid}`},s.createElement("img",{src:null===e.coverimage?"/assets/images/cover.png":e.coverimage,style:{width:"12em"}}))),s.createElement("div",{className:"col-md-6 text-center"},s.createElement("div",null,s.createElement("span",null,e.name)),s.createElement("div",{style:{marginTop:"1em",color:"#99a2aa"}},s.createElement("span",null,UTCTimeString2Local(e.createtime).slice(0,10))),s.createElement("div",{style:{marginTop:"1em",color:"#99a2aa"}},s.createElement("span",{style:{marginRight:"4em"}},s.createElement("i",{className:"far fa-thumbs-up"}),"   ",e.thumbupcount),s.createElement("span",{style:{marginRight:"0em"}},s.createElement("i",{className:"far fa-star"}),"   ",e.favorcount))),s.createElement("div",{className:"col-md-3 text-center"},s.createElement("div",{style:{marginTop:"1em",color:"#99a2aa",cursor:"pointer"},onClick:()=>{window.open("/index.html?#/creator?uid="+e.creator_id,"_blank")}},s.createElement("span",{style:{color:"green"}},e.creator_name)),s.createElement("div",{style:{marginTop:"1em",color:"#99a2aa"}},s.createElement("span",null,A[e.producttypeid]))))}render(){return s.createElement(v.B,{withoutSearchBox:!0,resourceUrl:"/api/etc",listbypage_extraPara:this.listbypage_extraPara,customListItem:this.customListItem})}}s.Component;class z extends s.Component{constructor(e){super(e),this.state={searchKeywords:"",curSearch:"account",items:[]},document.title="学习中心 - 黑羽学院"}navlink(e,t){return s.createElement(l.rU,{to:t,className:this.props.location.pathname===t?"nav-link active":"nav-link","data-toggle":"pill",role:"tab"},e)}render(){return s.createElement(s.Fragment,null,s.createElement("div",{className:"row",style:{marginTop:"0em"}},s.createElement("div",{className:"col-2"},s.createElement("div",{className:"nav flex-column nav-tabs",role:"tablist","aria-orientation":"vertical"},this.navlink("我的任务","/learn_center/assignment_tome"),this.navlink("我的报班","/learn_center/enroll_student"),this.navlink("我的收藏","/learn_center/myfavorite"),this.navlink("我的关注","/learn_center/myfollow"),this.navlink("统计分析","/learn_center/stats"))),s.createElement("div",{className:"col-10"},s.createElement("div",{className:"tab-content",id:"custom-tabs-four-tabContent"},s.createElement(p.rs,null,s.createElement(p.AW,{path:"/learn_center/assignment_tome",component:F}),s.createElement(p.AW,{path:"/learn_center/enroll_student",component:O}),s.createElement(p.AW,{path:"/learn_center/myfavorite",component:Y}))))))}genResult(){return this.state.items.length>0?this.state.items.map((e=>s.createElement("div",{className:"row search-result-item-2",key:e.id},s.createElement("div",{className:"col-md-2"},s.createElement("img",{src:e.avatar?e.avatar:"/assets/images/avatar.png",onClick:()=>{window.open("/index.html?#/creator?uid="+e.id,"_blank")},style:{width:"5em",cursor:"pointer",borderRadius:"50%"}})),s.createElement("div",{className:"col-md-10"},s.createElement("div",null,s.createElement("span",{style:{cursor:"pointer",fontSize:"1.2em",color:"#17a2b8"},onClick:()=>{window.open("/index.html?#/creator?uid="+e.id,"_blank")}},e.realname)),s.createElement("span",{style:{fontSize:".8em"}},"粉丝: ",e.followedcount),e.myself?s.createElement("span",{style:{marginLeft:"1em"}},"我自己"):s.createElement(s.Fragment,null,e.myteacher?s.createElement("span",{style:{marginLeft:"1em",cursor:"pointer"}},"我的老师"):null,e.mystudent?s.createElement("span",{style:{marginLeft:"1em",cursor:"pointer"}},"我的学生"):null))))):2===this.searchState?s.createElement("h5",{style:{marginTop:"1em"}}," 没有找到    "):1===this.searchState?s.createElement("h5",{style:{marginTop:"1em"}}," 搜索中...    "):null}}class j extends s.Component{constructor(e){super(e),this.info={homePageConfig:null},this.withoutAdd=!1,this.onAddToHomePage=this.onAddToHomePage.bind(this),this.listbypage_extraPara={action:"listbypage_allstate",withoutcontent:!0},this.searchBoxHint="标题名/作者 关键字搜索",this.BOTTOM_BUTTON_ACTION_TABLE={封禁:{name:"封禁",showCondition:e=>1===e.status,onClick:(e,t)=>{this.onBanOne(e,t)}},解禁:{name:"解禁",showCondition:e=>3===e.status,onClick:(e,t)=>{this.onPublishOne(e,t)}},加入首页banner:{name:"加入首页banner",showCondition:e=>null!=this.info.homePageConfig&&1===e.status&&o._Y.findInHomePageLocation(this.info.homePageConfig.banner,e,this.type)<0,onClick:(e,t)=>{this.onAddToHomePage(e,"banner",t)}},移出首页banner:{name:"移出首页banner",showCondition:e=>null!=this.info.homePageConfig&&1===e.status&&o._Y.findInHomePageLocation(this.info.homePageConfig.banner,e,this.type)>=0,onClick:(e,t)=>{this.onDeleteFromHomePage(e,"banner",t)},style:{color:"#d81b60"}},加入首页hot:{name:"加入首页hot",showCondition:e=>null!=this.info.homePageConfig&&1===e.status&&o._Y.findInHomePageLocation(this.info.homePageConfig.hot,e,this.type)<0,onClick:(e,t)=>{this.onAddToHomePage(e,"hot",t)}},移出首页hot:{name:"移出首页hot",showCondition:e=>null!=this.info.homePageConfig&&1===e.status&&o._Y.findInHomePageLocation(this.info.homePageConfig.hot,e,this.type)>=0,onClick:(e,t)=>{this.onDeleteFromHomePage(e,"hot",t)},style:{color:"#d81b60"}},加入首页news:{name:"加入首页news",showCondition:e=>null!=this.info.homePageConfig&&1===e.status&&o._Y.findInHomePageLocation(this.info.homePageConfig.news,e,this.type)<0,onClick:(e,t)=>{this.onAddToHomePage(e,"news",t)}},移出首页news:{name:"移出首页news",showCondition:e=>null!=this.info.homePageConfig&&1===e.status&&o._Y.findInHomePageLocation(this.info.homePageConfig.news,e,this.type)>=0,onClick:(e,t)=>{this.onDeleteFromHomePage(e,"news",t)},style:{color:"#d81b60"}},加入手推车:{name:"加入手推车",showCondition:e=>{if(1!==e.status)return!1;if(!o.R3.MAGIC_BAG.hasOwnProperty("lesson"))return!0;for(let t of o.R3.MAGIC_BAG.lesson)if(t.id===e.id)return!1;return!0},onClick:(e,t)=>{o._Y.magicBag.addOne("lesson",e),t.forceUpdate()}},移出手推车:{name:"移出手推车",showCondition:e=>{if(1!==e.status)return!1;if(!o.R3.MAGIC_BAG.hasOwnProperty("lesson"))return!1;for(let t of o.R3.MAGIC_BAG.lesson)if(t.id===e.id)return!0;return!1},onClick:(e,t)=>{o._Y.magicBag.removeOne("lesson",e),t.forceUpdate()},style:{color:"#d81b60"}},撤回:{name:"撤回",showCondition:e=>1===e.status,onClick:(e,t)=>{this.onHoldOne(e,t)}},发布:{name:"发布",showCondition:e=>2===e.status,onClick:(e,t)=>{this.onPublishOne(e,t)}},审核:{name:"审核",onClick:(e,t)=>{this.onReviewOne(e,t)}}},this.list_fields=[{name:"",attr:"name",type:"OneLineText"},{name:"作者：",attr:"creator_name",type:"OneLineText"}],this.addone_fields=[{name:"标题",attr:"name",type:"OneLineText",value:"",check_string_len:[2,100]},{name:"封面",attr:"coverimage",type:"SingleImg",value:null,imageStyle:{width:"20em"}},{name:"内容",attr:"content",type:"RichTextEditWithUploader",value:"",check_string_len:[1,5e4]}],this.searchResultCssClass=e=>{switch(e.status){case 1:return"search-result-item";case 2:return"search-result-item lock";case 3:return"search-result-item banned"}},this.ref_toast=s.createRef()}_add_category_tag_to_item_ifneed(e,t,a){this.display_category_tag&&(e.categorytags={selectedCategoryIds:t.rec.categoryIds,selectedTagIds:t.rec.tagIds},a.push({name:"分类 标签",attr:"categorytags",type:"CategoryTag",value:{selectedCategoryIds:t.rec.categoryIds,selectedTagIds:t.rec.tagIds}}))}async createFieldsWhenModifyOne(e){let t=await o._Y.rfetch("get",this.resourceUrl,{action:"getone",id:e.id});e.content=t.rec.content;let a=[{name:"标题",attr:"name",type:"OneLineText",value:e.name,check_string_len:[2,100]},{name:"封面",attr:"coverimage",type:"SingleImg",value:e.coverimage,imageStyle:{width:"20em"}},{name:"内容",attr:"content",type:"RichTextEditWithUploader",value:e.content,check_string_len:[1,5e5]}];return this._add_category_tag_to_item_ifneed(e,t,a),a}onBanOne(e,t){confirm(`确定要封禁此${this.resourceName}吗？`)&&o._Y.ajax_put(this.resourceUrl,{action:"banone",id:e.id},(a=>{0===a.ret&&(e.status=a.status,t.forceUpdate())}))}async onHoldOne(e,t){if(!confirm(`确定要撤回此${this.resourceName}吗？`))return;let a=await o._Y.rfetch("put",this.resourceUrl,{action:"holdone",id:e.id});e.status=a.status,t.forceUpdate()}onPublishOne(e,t){confirm(`确定要解禁此${this.resourceName}吗？`)&&o._Y.ajax_put(this.resourceUrl,{action:"publishone",id:e.id},(a=>{0===a.ret&&(e.status=a.status,t.forceUpdate())}))}async onAddToHomePage(e,t,a){if(o._Y.findInHomePageLocation(this.info.homePageConfig[t],e,this.type)>=0)return void altert(`该条目已经在首页 ${t} 栏`);let s=JSON.parse(JSON.stringify(this.info.homePageConfig));s[t].splice(0,0,{type:this.type,id:e.id}),await o._Y.setConfigHomePage(s),this.info.homePageConfig=s,a.forceUpdate()}async onDeleteFromHomePage(e,t,a){let s=o._Y.findInHomePageLocation(this.info.homePageConfig[t],e,this.type);if(-1===s)return void altert(`该条目不在首页 ${t} 栏`);let n=JSON.parse(JSON.stringify(this.info.homePageConfig));n[t].splice(s,1),await o._Y.setConfigHomePage(n),this.info.homePageConfig=n,a.forceUpdate()}render(){return s.createElement(s.Fragment,null,s.createElement(x,{ref:this.ref_toast}),s.createElement(v.C,{ref:this.pageviewRef,searchBoxHint:this.searchBoxHint,withoutAdd:this.withoutAdd,withoutDelete:this.withoutDelete,withoutModify:this.withoutModify,resourceName:this.resourceName,resourceUrl:this.resourceUrl,listbypage_extraPara:this.listbypage_extraPara,display_category_tag:this.display_category_tag,list_fields:this.list_fields,itemUrl:e=>`/view_one.html?type=${this.type}&id=${e.id}`,addone_fields:this.addone_fields,createFieldsWhenModifyOne:e=>this.createFieldsWhenModifyOne(e),modifyExtraHandle:this.modifyExtraHandle,addExtraHandle:this.addExtraHandle,customBottomButtons:this.customBottomButtons,customBottomElements:this.customBottomElements}))}}class V extends j{constructor(e){super(e),this.state={data:{items:[]},advs:[]},this.display_category_tag=!0,this.customBottomElements=[(e,t,a)=>0===e.approved?s.createElement("span",{key:t,className:"btn",style:{marginRight:"2em",color:"#03A9F4"}},"待审核"):2===e.approved?s.createElement("span",{key:t,className:"btn",style:{marginRight:"2em",color:"#d81b60",cursor:"pointer"},onClick:()=>{this.ref_toast.current.show("审核意见",e.reviewcomments)}},"审核不通过"):1===e.approved?s.createElement("span",{key:t,className:"btn",style:{marginRight:"2em",color:"gray"}},"审核通过"):null,(e,t,a)=>null]}}class K extends s.Component{constructor(e){super(e),document.title="单课 - 黑羽学院",this.resourceUrl="/api/lesson",this.resourceFields=[{name:"标题",attr:"name",type:"OneLineText",value:"",check_string_len:[2,100]},{name:"可见范围",attr:"usage",type:"SingleSelectFixedItems",value:1,items:[{text:"内部",value:2},{text:"公开",value:1}]},{name:"封面",attr:"coverimage",type:"SingleImg",value:null,imageStyle:{width:"20em"}},{name:"内容",attr:"content",type:"RichTextEditWithUploader",value:"",check_string_len:[1,5e4]},{name:"分类 标签",attr:"categorytags",type:"CategoryTag",value:{selectedCategoryIds:[],selectedTagIds:[]}}],this.ref_toast=s.createRef()}async componentDidMount(){}render(){return s.createElement(s.Fragment,null,s.createElement(x,{ref:this.ref_toast}),s.createElement(w,{resourceName:"单课",resourceUrl:this.resourceUrl,foldertype:"lesson",createFieldsWhenAddOne:()=>JSON.parse(JSON.stringify(this.resourceFields)),createFieldsWhenModifyOne:async e=>{let t=(await o._Y.rfetch("get",this.resourceUrl,{action:"getone",id:e})).rec,a=JSON.parse(JSON.stringify(this.resourceFields));return a[0].value=t.name,a[1].value=t.usage,a[2].value=t.coverimage,a[3].value=t.content,a[4].value.selectedCategoryIds=t.categoryIds,a[4].value.selectedTagIds=t.tagIds,a},customNodeInfo:e=>"file"===e.type?s.createElement(s.Fragment,null,s.createElement("div",{className:"col-md-3 text-left"},2===e.info.approved?s.createElement("span",{className:"no-text-select",style:{color:"#d81b60",cursor:"pointer"},onClick:()=>{this.ref_toast.current.show("审核意见",e.info.reviewcomments)}},"审核不通过"):null,0===e.info.approved?s.createElement("span",{className:"no-text-select",style:{color:"#03A9F4"}},"待审核"):null,1===e.info.approved?s.createElement("span",{className:"no-text-select",style:{color:"#03A9F4"}},"审核通过"):null),s.createElement("div",{className:"col-md-3 text-left"},s.createElement("span",{className:"no-text-select",style:{color:"#03A9F4"}},1===e.info.usage?"公开":"内部"))):null}))}}class J extends V{constructor(e){super(e),document.title="专题 - 黑羽学院",this.searchBoxHint="标题名 关键字搜索",this.type="course",this.resourceName="专题",this.resourceUrl="/api/course",this.list_fields=[{name:"",attr:"name",type:"OneLineText"},{name:"可见范围：",attr:"usage",type:"OneLineText",converter:e=>1===e?"公开":"内部",style:{display:"inline",color:"#4384ca"}}],this.listbypage_extraPara={action:"listbypage_onlymine",withoutcontent:!0},this.addone_fields=[{name:"标题",attr:"name",type:"OneLineText",value:"",check_string_len:[2,100]},{name:"可见范围",attr:"usage",type:"SingleSelectFixedItems",value:0,items:[{text:"内部",value:2},{text:"公开",value:1}]},{name:"封面",attr:"coverimage",type:"SingleImg",value:null,imageStyle:{width:"20em"}},{name:"内容",attr:"content",type:"RichTextEditWithUploader",value:"",check_string_len:[1,5e4]},{name:"课程内容",attr:"lessons",type:"FolderSelectWithSort",foldertype:"lesson",value:[],displayAttr:"name"},{name:"价格（单位：元）",attr:"price",type:"OneLineText",value:"0",check_int_range:[0,999999]},{name:"分类 标签",attr:"categorytags",type:"CategoryTag",value:{selectedCategoryIds:[],selectedTagIds:[]}}]}async createFieldsWhenModifyOne(e){let t=await o._Y.rfetch("get",this.resourceUrl,{action:"getone",id:e.id});e.content=t.rec.content,e.lessons=t.rec.lessons;let a=[{name:"标题",attr:"name",type:"OneLineText",value:e.name,check_string_len:[2,100]},{name:"用途",attr:"usage",type:"SingleSelectFixedItems",value:e.usage,items:[{text:"内部",value:2},{text:"公开",value:1}]},{name:"封面",attr:"coverimage",type:"SingleImg",value:e.coverimage,imageStyle:{width:"20em"}},{name:"内容",attr:"content",type:"RichTextEditWithUploader",value:e.content,check_string_len:[1,5e5]},{name:"课程内容",attr:"lessons",type:"FolderSelectWithSort",foldertype:"lesson",value:JSON.parse(JSON.stringify(e.lessons)),displayAttr:"name"},{name:"价格（单位：元）",attr:"price",type:"OneLineText",value:e.price,check_int_range:[0,999999]}];return this._add_category_tag_to_item_ifneed(e,t,a),a}}class G extends s.Component{constructor(e){super(e),this.info={curItem:null,curChoice:""},this.pageviewRef=s.createRef(),this.popupInputPara={submitFunc:async e=>{await o._Y.rfetch("post",this.resourceUrl,{action:"reviewresult",id:this.info.curItem.id,result:this.info.curChoice,comments:""===e?null:e}),this.pageviewRef.current.listbypage()}}}render(){return s.createElement(s.Fragment,null,s.createElement(N,{upInf:this.popupInputPara}),s.createElement(v.B,{ref:this.pageviewRef,searchBoxHint:"标题名/作者 关键字搜索",resourceUrl:this.resourceUrl,listbypage_method:"post",listbypage_extraPara:{action:"listbypage_reviewstate",withoutcontent:!0},list_fields:[{name:"作品名：",attr:"name",type:"OneLineText"},{name:"作者：",attr:"creator_name",type:"OneLineText"},{name:"ID：",attr:"id",type:"OneLineText"},{name:"状态：",attr:"approved",type:"OneLineText",converter:e=>y[e]}],itemUrl:e=>`/view_one.html?type=${this.type}&id=${e.id}`,customBottomButtons:[{name:"审核通过",onClick:async(e,t)=>{this.info.curItem=e,this.info.curChoice="pass",this.popupInputPara.show()}},{name:"审核不通过",onClick:async(e,t)=>{this.info.curItem=e,this.info.curChoice="modify",this.popupInputPara.show()}}],filters:this.filters=[{name:"显示全部",attr:"showall",type:"FlipButton",value:!1}]}))}}class Z extends G{constructor(e){super(e),document.title="审核单课 - 黑羽学院",this.type="lesson",this.resourceUrl="/api/lesson"}}class q extends G{constructor(e){super(e),document.title="审核专题 - 黑羽学院",this.type="course",this.resourceUrl="/api/course"}}function X(e){return s.createElement(s.Fragment,null,s.createElement(D,{menus:[{title:"审核课程",name:"lesson",component:Z},{title:"审核专题",name:"course",component:q}],curMenu:"lesson"}))}class Q extends s.Component{constructor(e){super(e),this.state={searchKeywords:"",curSearch:"account",items:[]},document.title="教学中心 - 黑羽学院"}navlink(e,t){return s.createElement(l.rU,{to:t,className:this.props.location.pathname===t?"nav-link active":"nav-link","data-toggle":"pill",role:"tab"},e)}render(){return s.createElement(s.Fragment,null,s.createElement("div",{className:"row",style:{marginTop:"0em"}},s.createElement("div",{className:"col-2"},s.createElement("div",{className:"nav flex-column nav-tabs",role:"tablist","aria-orientation":"vertical"},this.navlink("单课制作","/teach_center/lesson_mgr"),this.navlink("专题制作","/teach_center/course_mgr"),this.navlink("学习班","/teach_center/sclass_mgr"),this.navlink("报名学员","/teach_center/enroll_mgr"),this.navlink("任务管理","/teach_center/task_mgr"),this.navlink("任务分派","/teach_center/assignment_fromme"),this.navlink("统计分析","/teach_center/stats"))),s.createElement("div",{className:"col-10"},s.createElement("div",{className:"tab-content",id:"custom-tabs-four-tabContent"},s.createElement(p.rs,null,s.createElement(p.AW,{path:"/teach_center/lesson_mgr",component:K}),s.createElement(p.AW,{path:"/teach_center/course_mgr",component:J}),s.createElement(p.AW,{path:"/teach_center/sclass_mgr",component:k}),s.createElement(p.AW,{path:"/teach_center/enroll_mgr",component:I}),s.createElement(p.AW,{path:"/teach_center/task_mgr",component:U}),s.createElement(p.AW,{path:"/teach_center/assignment_fromme",component:P}))))))}genResult(){return this.state.items.length>0?this.state.items.map((e=>s.createElement("div",{className:"row search-result-item-2",key:e.id},s.createElement("div",{className:"col-md-2"},s.createElement("img",{src:e.avatar?e.avatar:"/assets/images/avatar.png",onClick:()=>{window.open("/index.html?#/creator?uid="+e.id,"_blank")},style:{width:"5em",cursor:"pointer",borderRadius:"50%"}})),s.createElement("div",{className:"col-md-10"},s.createElement("div",null,s.createElement("span",{style:{cursor:"pointer",fontSize:"1.2em",color:"#17a2b8"},onClick:()=>{window.open("/index.html?#/creator?uid="+e.id,"_blank")}},e.realname)),s.createElement("span",{style:{fontSize:".8em"}},"粉丝: ",e.followedcount),e.myself?s.createElement("span",{style:{marginLeft:"1em"}},"我自己"):s.createElement(s.Fragment,null,e.myteacher?s.createElement("span",{style:{marginLeft:"1em",cursor:"pointer"}},"我的老师"):null,e.mystudent?s.createElement("span",{style:{marginLeft:"1em",cursor:"pointer"}},"我的学生"):null))))):2===this.searchState?s.createElement("h5",{style:{marginTop:"1em"}}," 没有找到    "):1===this.searchState?s.createElement("h5",{style:{marginTop:"1em"}}," 搜索中...    "):null}}var ee=a(7407);class te extends s.Component{constructor(e){console.log("in User:: constructor"),super(e);let t=o._Y.getUrlParameter("uid");this.state={curView:"sclass",uid:t,user:{}}}async getUserView(e){let t=await o._Y.rfetch("get","/api/etc",{action:"getuserview",uid:e});this.setState({uid:e,user:t.user})}componentDidMount(){console.log("in User:: componentDidMount");let e=o._Y.getUrlParameter("uid");this.getUserView(e)}componentDidUpdate(e){console.log("in User:: componentDidUpdate");let t=o._Y.getUrlParameter("uid");t!==this.state.uid&&this.getUserView(t)}render(){let e=this.state.user;return s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-9"},s.createElement("div",{className:"card",style:{boxShadow:"0 0 1px"}},s.createElement("div",{className:"card-header p-2"},s.createElement("ul",{className:"nav nav-pills"},s.createElement("li",{className:"nav-item",style:{cursor:"pointer"},onClick:()=>{this.setState({curView:"sclass"})}},s.createElement("a",{className:"nav-link active","data-toggle":"tab"},"他的学习班")),s.createElement("li",{className:"nav-item",style:{cursor:"pointer"},onClick:()=>{this.setState({curView:"lesson"})}},s.createElement("a",{className:"nav-link","data-toggle":"tab"},"他的课")),s.createElement("li",{className:"nav-item",style:{cursor:"pointer"},onClick:()=>{this.setState({curView:"course"})}},s.createElement("a",{className:"nav-link","data-toggle":"tab"},"他的专题")))),s.createElement("div",{className:"card-body",style:{minHeight:"40em"}},s.createElement("div",{className:"tab-content"},s.createElement("div",{className:"active tab-pane"},"sclass"===this.state.curView?s.createElement(S,{uid:this.state.uid}):"lesson"===this.state.curView?s.createElement(H,{uid:this.state.uid,without:"creatorinfo"}):"course"===this.state.curView?s.createElement(W,{uid:this.state.uid,without:"creatorinfo"}):null))," ")," ")," "),s.createElement("div",{className:"col-md-3"},s.createElement("div",{className:"card card-primary card-outline",style:{boxShadow:"0 0 1px"}},s.createElement("div",{className:"card-body box-profile"},s.createElement("div",{className:"text-center"},s.createElement("img",{style:{width:"5em",cursor:"pointer",borderRadius:"50%"},src:e.avatar?e.avatar:"/assets/images/avatar.png",alt:"User profile picture"})),s.createElement("h6",{className:"text-center"},e.realname),s.createElement("p",{className:"text-muted text-center"},e.username),s.createElement("ul",{className:"list-group list-group-unbordered mb-3"},s.createElement("li",{className:"list-group-item"},s.createElement("span",null,"点赞")," ",s.createElement("a",{className:"float-right"},e.thumbups)),s.createElement("li",{className:"list-group-item"},s.createElement("span",null,"收藏")," ",s.createElement("a",{className:"float-right"},e.favorites)),s.createElement("li",{className:"list-group-item"},s.createElement("span",null,"粉丝")," ",s.createElement("a",{className:"float-right"},e.followedcount)),s.createElement("li",{className:"list-group-item"},s.createElement("span",null,"学生")," ",s.createElement("a",{className:"float-right"},e.students))),s.createElement("button",{className:"btn btn-green btn-outlined  btn-block",onClick:async()=>{e.followedhim&&!confirm("要取消关注吗？")||(await o._Y.rfetch("post","/api/etc",{action:"follow",targetid:this.state.uid,iscancel:e.followedhim}),e.followedhim=!e.followedhim,e.followedcount=e.followedhim?e.followedcount+1:e.followedcount-1,this.forceUpdate())}},e.followedhim?"已关注":"关注"))),s.createElement("div",{className:"card card-primary",style:{boxShadow:"0 0 1px"}},s.createElement("div",{className:"card-header",style:{textAlign:"center",color:"#17a2b8",fontSize:"1.1em"}},"个人信息"),s.createElement("div",{className:"card-body",style:{fontSize:".9em"}},s.createElement(ee.aw,{value:e.desc?e.desc:"尚未填写"})))))}}var ae=a(5008);class se extends s.Component{constructor(e){console.log("in User:: constructor"),super(e);let t=parseInt(o._Y.getUrlParameter("uid"));this.state={curView:"sclass",uid:t,info:{},basicInfoEditing:!1,enrollClassIdEditing:null,showTaskAssignDialog:!1},this.assignedTasks=[],document.title="我的学员 - 黑羽学院"}async getStudentInfo(e){let t=await o._Y.rfetch("get","/api/etc",{action:"getstudentinfo",studentid:e});this.setState({uid:e,info:t.info})}componentDidMount(){console.log("in User:: componentDidMount");let e=parseInt(o._Y.getUrlParameter("uid"));this.getStudentInfo(e)}componentDidUpdate(e){let t=parseInt(o._Y.getUrlParameter("uid"));t!==this.state.uid&&this.getStudentInfo(t)}render_basicInfo(e){let t=[{name:"能力等级",attr:"caplevel",type:"OneLineText",value:e.caplevel?e.caplevel:"",check_string_len:[0,20]},{name:"学习态度",attr:"actlevel",type:"OneLineText",value:e.actlevel?e.actlevel:"",check_string_len:[0,20]},{name:"学员备注",attr:"desc",type:"MultiLineText",rows:"8",value:e.desc?e.desc:"尚未填写",check_string_len:[0,20]}];return this.state.basicInfoEditing?s.createElement(b.Z,{style:{border:""},data:{fields:t},onEditOK:async t=>{await o._Y.rfetch("post","/api/etc",{action:"setstudentbasicinfo",studentid:this.state.uid,info:t}),Object.assign(e,t),this.setState({basicInfoEditing:!1})},onEditCancel:()=>{this.setState({basicInfoEditing:!1})}}):s.createElement("div",{className:"card-body box-profile"},s.createElement("div",{className:"text-center"},s.createElement("img",{style:{width:"5em",cursor:"pointer",borderRadius:"50%"},src:e.avatar?e.avatar:"/assets/images/avatar.png",alt:"User profile picture"})),s.createElement("p",{className:"text-muted text-center"},e.name),s.createElement("ul",{className:"list-group list-group-unbordered mb-3"},s.createElement("li",{className:"list-group-item"},s.createElement("span",null,"能力等级")," ",s.createElement("a",{className:"float-right",style:{color:"gray"}},e.caplevel?e.caplevel:"未填写")),s.createElement("li",{className:"list-group-item"},s.createElement("span",null,"学习态度")," ",s.createElement("a",{className:"float-right",style:{color:"gray"}},e.actlevel?e.actlevel:"未填写")),s.createElement("li",{className:"list-group-item"},s.createElement("span",null,"学员备注")," ",s.createElement("br",null),s.createElement("p",{style:{whiteSpace:"pre-wrap",color:"gray"}},e.desc?e.desc:"未填写"," "))),s.createElement("button",{className:"btn btn-green btn-outlined  btn-block btn-sm",onClick:()=>this.setState({basicInfoEditing:!0})},"修改基本信息"),s.createElement("button",{className:"btn btn-green btn-outlined  btn-block btn-sm",onClick:()=>{this.assignedTasks=[],this.setState({showTaskAssignDialog:!0})}},"分配任务"))}render_sclass(e){return e?e.map(((e,t,a)=>s.createElement("div",{key:e.sclassid,className:"search-result-item-2",style:{borderBottom:a.length-1===t?"":"1px solid #f4f0e9",color:"#6c757d"}},this.state.enrollClassIdEditing===e.sclassid?s.createElement(b.Z,{data:{fields:[{name:"学费",attr:"fee",type:"OneLineText",value:e.fee,check_string_len:[1,10]},{name:"状态",attr:"status",type:"SingleSelectFixedItems",value:e.status,items:[{text:"学习中",value:1},{text:"已毕业",value:2},{text:"暂停学习",value:3}]},{name:"备注",attr:"desc",type:"MultiLineText",rows:"5",value:e.desc,check_string_len:[0,300]}]},onEditOK:async t=>{await o._Y.rfetch("post","/api/etc",{action:"setstudentenrollinfo",studentid:this.state.uid,sclassid:e.sclassid,info:t}),Object.assign(e,t),this.setState({enrollClassIdEditing:null})},onEditCancel:()=>{this.setState({enrollClassIdEditing:null})}}):s.createElement(s.Fragment,null,s.createElement("div",{className:"col-md-3 text-center"},s.createElement("a",{target:"_blank",style:{cursor:"pointer",marginRight:"0"},onClick:()=>{window.open(`/view_one.html?type=sclass&id=${e.sclassid}`,"_blank")}},s.createElement("img",{src:null===e.coverimage?"/assets/images/cover.png":e.coverimage,style:{width:"10em"}}))),s.createElement("div",{className:"col-md-3 text-center"},s.createElement("div",{style:{margin:"0"}},s.createElement("span",null,e.sclassname)),s.createElement("div",{style:{margin:".5em 0"}},s.createElement("span",null,UTCTimeString2Local(e.enrolltime).slice(0,16))),s.createElement("div",{style:{margin:".5em 0"}},s.createElement("span",{style:{color:1===e.status?"green":2===e.status?"gray":"red",fontSize:"1em",marginRight:"1em "}},E[e.status]),s.createElement("span",{style:{color:"#ff7501",fontSize:"1em"}},"￥",e.fee))),s.createElement("div",{className:"col-md-5 text-center",style:{}},s.createElement("div",{style:{margin:"0"}},s.createElement("p",{style:{fontSize:"1em",whiteSpace:"pre-wrap"}},e.desc?e.desc:"未填写"))),s.createElement("div",{className:"col-md-1 text-center",style:{marginTop:"2em"}},s.createElement("span",{style:{color:"#03a9f4",cursor:"pointer"},onClick:()=>{this.setState({enrollClassIdEditing:e.sclassid})}},"  修改 ")))))):null}render(){let e=this.state.info;return s.createElement(s.Fragment,null,s.createElement("div",{className:"row"},s.createElement("div",{className:"col-md-8"},s.createElement("div",{className:"card",style:{boxShadow:"0 0 1px"}},s.createElement("div",{className:"card-header p-2"},s.createElement("ul",{className:"nav nav-pills"},s.createElement("li",{className:"nav-item",style:{cursor:"pointer"},onClick:()=>{this.setState({curView:"sclass"})}},s.createElement("a",{className:"nav-link  active","data-toggle":"tab"},"报班信息")),s.createElement("li",{className:"nav-item",style:{cursor:"pointer"},onClick:()=>{this.setState({curView:"learnning"})}},s.createElement("a",{className:"nav-link","data-toggle":"tab"},"学习进度")))),s.createElement("div",{className:"card-body",style:{minHeight:"40em"}},s.createElement("div",{className:"tab-content"},s.createElement("div",{className:"active tab-pane"},"sclass"===this.state.curView?this.render_sclass(e.enrolls):"learnning"===this.state.curView?s.createElement(P,{receiverid:this.state.uid}):null))," ")," ")," "),s.createElement("div",{className:"col-md-4"},s.createElement("div",{className:"card card-primary card-outline",style:{boxShadow:"0 0 1px"}},this.render_basicInfo(e)))),this.state.showTaskAssignDialog?s.createElement("div",{className:"modal fade show",style:{display:"block",paddingRight:"17px",backgroundColor:"#17171661"}},s.createElement("div",{className:"modal-dialog modal-xl"},s.createElement("div",{className:"modal-content"},s.createElement("div",{className:"modal-header"},s.createElement("h5",{className:"modal-title"},`给${e.name}分配任务`)),s.createElement("div",{className:"modal-body"},s.createElement(ae.Fg,{items:this.assignedTasks,displayAttr:"name",foldertype:"task"})),s.createElement("div",{className:"modal-footer"},s.createElement("button",{type:"button",className:"btn btn-default",onClick:()=>{this.setState({showTaskAssignDialog:!1})}},"取消"),s.createElement("button",{type:"button",className:"btn btn-default",onClick:async()=>{await o._Y.rfetch("post","/api/assignment",{action:"assign",tasks:this.assignedTasks.map((e=>e.id)),students:[this.state.uid]}),alert("任务下发成功"),this.setState({showTaskAssignDialog:!1})}},"确定"))))):null)}}var ne=a(4182);class re extends s.Component{constructor(e){super(e),this.state={status:"viewing"},document.title="个人中心 - 黑羽学院"}componentDidMount(){this.props.getMyProfile()}render(){return s.createElement(s.Fragment,null,this.props.permissions.includes("common.creator")?null:s.createElement("button",{className:"btn-green btn-outlined btn-md",onClick:()=>this.props.history.push("/wf_creatorapply_list_forapply")},"申请成为创作者"),"viewing"==this.state.status?this.renderViewStatus():this.renderEditStatus())}renderViewStatus(){return s.createElement(s.Fragment,null,s.createElement("div",{style:{marginTop:"1em"}},s.createElement("div",{style:{margin:"0 1em .9em 25%"}},s.createElement("span",{className:"search-result-item-field-name"},"账号："),s.createElement("span",null,this.props.profile.username)),s.createElement("div",{style:{margin:"0 1em .9em 25%"}},s.createElement("span",{className:"search-result-item-field-name"},"头像："),this.props.profile.avatar?s.createElement("img",{src:this.props.profile.avatar,className:"img-circle",style:{width:"2em",height:"2em"}}):null),s.createElement("div",{style:{margin:"0 1em .9em 25%"}},s.createElement("span",{className:"search-result-item-field-name"},"姓名："),s.createElement("span",null,this.props.profile.realname)),s.createElement("div",{style:{margin:"0 1em .9em 25%"}},s.createElement("span",{className:"search-result-item-field-name"},"手机："),s.createElement("span",null,this.props.profile.phonenumber)),s.createElement("div",{style:{margin:"0 1em .9em 25%"}},s.createElement("span",{className:"search-result-item-field-name"},"邮箱："),s.createElement("span",null,this.props.profile.email)),s.createElement("div",{style:{margin:"0 1em .9em 25%"}},s.createElement("span",{className:"search-result-item-field-name"},"个人简介："),s.createElement("p",{style:{whiteSpace:"pre-wrap",color:"gray"}},this.props.profile.desc)),s.createElement("div",{style:{display:"flex",marginTop:"1em"}},s.createElement("span",{type:"button",className:"btn-green btn-outlined btn-sm",style:{margin:"0 38% auto"},onClick:()=>{this.props.profile.password="******",this.editing_data=JSON.parse(JSON.stringify(this.props.profile)),this.setState({status:"editing"})}},s.createElement("i",{className:"fas fa-pen"})," 编辑"))))}renderEditStatus(){return s.createElement("div",{style:{marginTop:"1em"}},s.createElement("div",{style:{padding:"1em"}},"姓名",s.createElement("input",{className:"form-control",type:"text",value:this.editing_data.realname,onChange:e=>{this.editing_data.realname=e.target.value,this.forceUpdate()}})),s.createElement("div",{style:{padding:"1em"}},"头像",s.createElement(ne.A,{imageUrl:this.editing_data.avatar,imageChanged:e=>{this.editing_data.avatar=e},imageStyle:{width:"3em",height:"3em",borderRadius:"50%"}})),s.createElement("div",{style:{padding:"1em"}},"密码",s.createElement("input",{className:"form-control",type:"text",value:this.editing_data.password,onChange:e=>{this.editing_data.password=e.target.value,this.forceUpdate()}})),s.createElement("div",{style:{padding:"1em"}},"手机",s.createElement("input",{className:"form-control",type:"text",value:this.editing_data.phonenumber,onChange:e=>{this.editing_data.phonenumber=e.target.value,this.forceUpdate()}})),s.createElement("div",{style:{padding:"1em"}},"邮箱",s.createElement("input",{className:"form-control",type:"text",value:this.editing_data.email,onChange:e=>{this.editing_data.email=e.target.value,this.forceUpdate()}})),s.createElement("div",{style:{padding:"1em"}},"个人简介",s.createElement("textarea",{className:"form-control form-control-sm",value:this.editing_data.desc,rows:"10",onChange:e=>{this.editing_data.desc=e.target.value,this.forceUpdate()}})),s.createElement("div",{style:{display:"flex"}},s.createElement("div",{className:"btn-group btn-group-sm","data-toggle":"buttons",style:{margin:"0 auto"}},s.createElement("label",{type:"button",className:"btn-green btn-outlined btn-xs",onClick:()=>{this.props.setMyProfile(this.editing_data,this.props.profile),this.setState({status:"viewing"})}},"确定"),s.createElement("label",{type:"button",className:"btn-green btn-outlined btn-xs",onClick:()=>{this.setState({status:"viewing"})}},"取消"))))}}const ie=(0,i.$j)((e=>({profile:e.profile,permissions:e.permissions})),(e=>({getMyProfile:()=>{o._Y.ajax_get("/api/etc",{action:"getmyprofile"},(t=>{e({type:"FETCH_PROFILE_PERMISSION_SUCCESS",profile:t.profile,permissions:t.permissions})}))},setMyProfile:(t,a)=>{let s={},n=Object.getOwnPropertyNames(t);for(let e of n)t[e]!=a[e]&&(s[e]=t[e]);0!==Object.keys(s).length?o._Y.ajax_post("/api/etc",{action:"setmyprofile",newdata:s},(a=>{e({type:"FETCH_PROFILE_SUCCESS",profile:t})})):alert("用户信息没有任何修改")}})))(re);var le=a(8463);let oe="创作者申请",ce="/api/wf_creator_apply";class me extends le.a{constructor(e){super(e),document.title="创作者申请工作流 - 黑羽学院",this.workflowname=oe,this.workflowApiUrl=ce,this.list_fields=[{name:"",attr:"title",type:"OneLineText"}],this.pagesize=20,this.filters=[{name:"只显示待处理",attr:"state_ongoing",type:"FlipButton",value:!1}]}searchResultCssClass(e){switch(e.currentstate){case"中止":return"search-result-item banned";case"结束":return"search-result-item";default:return"search-result-item plane"}}}class de extends me{constructor(e){super(e),this.api_list_action="listminebypage",this.handleOneUrl="/index.html#/wf_creatorapply_one?backtolisturl=wf_creatorapply_list_forapply&id="}}class pe extends me{constructor(e){super(e),this.api_list_action="listallbypage",this.handleOneUrl="/index.html#/wf_creatorapply_one?backtolisturl=wf_creatorapply_list_forreview&id=",this.PAGE_TITLE="审核 创作者申请",this.WITHOUT_CREATE_BUTTON=!0}}class he extends le.O{constructor(e){super(e),this.workflowname=oe,this.workflowApiUrl=ce}}var ue=a(6671);class ge extends s.Component{constructor(e){super(e),this.hash=window.location.hash.split("?")[0].substring(2)}render(){return s.createElement(l.UT,null,s.createElement("div",{className:"content-wrapper"},s.createElement("div",{className:"content container-fluid",style:{paddingTop:"1em"}},s.createElement(p.rs,null,s.createElement(p.AW,{exact:!0,path:"/",component:u}),s.createElement(p.AW,{path:"/home",component:u}),s.createElement(p.AW,{path:"/search",component:g}),s.createElement(p.AW,{path:"/learn_center",component:z}),s.createElement(p.AW,{path:"/teach_center",component:Q}),s.createElement(p.AW,{path:"/creator",component:te}),s.createElement(p.AW,{path:"/student",component:se}),s.createElement(p.AW,{path:"/profile",component:ie}),s.createElement(p.AW,{path:"/all_lesson",component:B}),s.createElement(p.AW,{path:"/all_course",component:M}),s.createElement(p.AW,{path:"/myfavorite",component:Y}),s.createElement(p.AW,{path:"/enroll_mgr",component:I}),s.createElement(p.AW,{path:"/notification_self",component:T}),s.createElement(p.AW,{path:"/assignment_tome",component:F}),s.createElement(p.AW,{path:"/assignment_fromme",component:P}),s.createElement(p.AW,{path:"/review",component:X}),s.createElement(p.AW,{path:"/news",component:C}),s.createElement(p.AW,{path:"/wf_creatorapply_list_forapply",component:de}),s.createElement(p.AW,{path:"/wf_creatorapply_list_forreview",component:pe}),s.createElement(p.AW,{path:"/wf_creatorapply_one",component:he}),s.createElement(p.AW,{path:"/wf_general_list",component:ue.m}),s.createElement(p.AW,{path:"/wf_general_one",component:ue._})))))}}const fe=(0,i.$j)((e=>({profile:e.profile})),(e=>({onAddOne:e=>{}})))(ge),ye=(0,i.$j)((e=>({profile:e.profile})),(e=>({onAddOne:e=>{}})))(class extends m{constructor(e){super(e),this.iconUrl="/assets/images/logo.png",this.navibarColor="white"}genAllMenuItem(){return s.createElement(s.Fragment,null,this._genOneMenuItem("home","首页","/home"),this._genOneMenuItem("all_lesson","单课","/all_lesson"),this._genOneMenuItem("all_course","专题","/all_course"),this._genOneMenuItem("news","新闻","/news"),this._genOneMenuItem("news","官网","http://www.byhy.net"))}genNavRightPart(){return s.createElement("ul",{className:"order-1 order-md-3 navbar-nav navbar-no-expand ml-auto"},s.createElement("li",{className:"nav-item"},s.createElement("a",{className:"nav-link",href:"/sign.html"},s.createElement("i",{className:"fas fa-sign-in-alt"}),"  登录")))}});class Ee extends s.Component{constructor(e){super(e)}render(){return s.createElement(l.UT,null,s.createElement("div",{className:"content-wrapper"},s.createElement("div",{className:"content container-fluid"},s.createElement(p.AW,{exact:!0,path:"/",component:u}),s.createElement(p.AW,{exact:!0,path:"/home",component:u}),s.createElement(p.AW,{exact:!0,path:"/all_lesson",component:B}),s.createElement(p.AW,{exact:!0,path:"/all_course",component:M}),s.createElement(p.AW,{exact:!0,path:"/news",component:C}))))}}const ve=(0,i.$j)((e=>({profile:e.profile})),(e=>({onAddOne:e=>{}})))(Ee);var _e=a(4470);let be=(0,r.MT)(c,{profile:{realname:"用户",username:""}});window.reduxStore=be;let we=parseInt(sessionStorage.getItem("usertype")),Ne={};we?we<=1e3?(Ne.header=s.createElement(ye,null),Ne.content=s.createElement(ve,null)):(Ne.header=s.createElement(d,null),Ne.content=s.createElement(fe,null)):(Ne.header=s.createElement(ye,null),Ne.content=s.createElement(ve,null)),n.render(s.createElement(i.zt,{store:be},s.createElement(l.UT,null,s.createElement(s.Fragment,null,Ne.header,Ne.content,s.createElement(_e.Z,null)))),document.getElementById("root"))},3609:e=>{e.exports=jQuery}},a={};function s(e){var n=a[e];if(void 0!==n)return n.exports;var r=a[e]={exports:{}};return t[e](r,r.exports,s),r.exports}s.m=t,e=[],s.O=(t,a,n,r)=>{if(!a){var i=1/0;for(c=0;c<e.length;c++){for(var[a,n,r]=e[c],l=!0,o=0;o<a.length;o++)(!1&r||i>=r)&&Object.keys(s.O).every((e=>s.O[e](a[o])))?a.splice(o--,1):(l=!1,r<i&&(i=r));l&&(e.splice(c--,1),t=n())}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[a,n,r]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={826:0,761:0};s.O.j=t=>0===e[t];var t=(t,a)=>{var n,r,[i,l,o]=a,c=0;for(n in l)s.o(l,n)&&(s.m[n]=l[n]);if(o)var m=o(s);for(t&&t(a);c<i.length;c++)r=i[c],s.o(e,r)&&e[r]&&e[r][0](),e[i[c]]=0;return s.O(m)},a=self.webpackChunkstatic=self.webpackChunkstatic||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var n=s.O(void 0,[220,543,240,644,555,671],(()=>s(6837)));n=s.O(n)})();